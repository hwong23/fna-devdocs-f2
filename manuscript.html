<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Harry Wong, ing." />
  <meta name="author" content="Eddie Hernandez, ing." />
  <meta name="author" content="Federico Suárez, ing." />
  <meta name="author" content="Darío Correal, ing." />
  <meta name="dcterms.date" content="2023-02-06" />
  <meta name="keywords" content="SOA, madurez, gobierno" />
  <title>Diagnóstico SOA Actual FNA</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/main/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta property="og:type" content="article" />
  <meta name="dc.title" content="Diagnóstico SOA Actual FNA" />
  <meta name="citation_title" content="Diagnóstico SOA Actual FNA" />
  <meta property="og:title" content="Diagnóstico SOA Actual FNA" />
  <meta property="twitter:title" content="Diagnóstico SOA Actual FNA" />
  <meta name="dc.date" content="2023-02-06" />
  <meta name="citation_publication_date" content="2023-02-06" />
  <meta property="article:published_time" content="2023-02-06" />
  <meta name="dc.modified" content="2023-02-06T17:14:28+00:00" />
  <meta property="article:modified_time" content="2023-02-06T17:14:28+00:00" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Harry Wong, ing." />
  <meta name="citation_author_institution" content="Arquitecto SOA, Stefanini" />
  <meta name="citation_author" content="Eddie Hernandez, ing." />
  <meta name="citation_author_institution" content="Datos, Stefanini" />
  <meta name="citation_author" content="Federico Suárez, ing." />
  <meta name="citation_author_institution" content="Infraestructura, Stefanini" />
  <meta name="citation_author" content="Darío Correal, ing." />
  <meta name="citation_author_institution" content="Arquitecto TI, Stefanini" />
  <link rel="canonical" href="https://hwong23.github.io/fna-devdocs-f2/" />
  <meta property="og:url" content="https://hwong23.github.io/fna-devdocs-f2/" />
  <meta property="twitter:url" content="https://hwong23.github.io/fna-devdocs-f2/" />
  <meta name="citation_fulltext_html_url" content="https://hwong23.github.io/fna-devdocs-f2/" />
  <meta name="citation_pdf_url" content="https://hwong23.github.io/fna-devdocs-f2/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://hwong23.github.io/fna-devdocs-f2/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://hwong23.github.io/fna-devdocs-f2/v/9b3a97c48493c199d06aec4a0753e3efa5cab65e/" />
  <meta name="manubot_html_url_versioned" content="https://hwong23.github.io/fna-devdocs-f2/v/9b3a97c48493c199d06aec4a0753e3efa5cab65e/" />
  <meta name="manubot_pdf_url_versioned" content="https://hwong23.github.io/fna-devdocs-f2/v/9b3a97c48493c199d06aec4a0753e3efa5cab65e/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Diagnóstico SOA Actual FNA</h1>
</header>
<p>Documentación del proyecto 181-2020, E-Service,
(<a href="https://hwong23.github.io/fna-devdocs-f2/v/9b3a97c48493c199d06aec4a0753e3efa5cab65e/">permalink</a>)
versión indicada a continuación, se encuentra en
<a href="https://github.com/hwong23/fna-devdocs-f2/tree/9b3a97c48493c199d06aec4a0753e3efa5cab65e">9b3a97c</a>
on February 6, 2023.</p>
<h2 id="grupo-e-service">Grupo E-Service</h2>
<ul>
<li><p><strong>Harry Wong, ing.</strong>
<br>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/e_hwong">e_hwong</a>
<br>
<small>
Arquitecto SOA, Stefanini
</small></p></li>
<li><p><strong>Eddie Hernandez, ing.</strong>
<br>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/e_ehernandez">e_ehernandez</a>
<br>
<small>
Datos, Stefanini
</small></p></li>
<li><p><strong>Federico Suárez, ing.</strong>
<br>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/e_fsuarez">e_fsuarez</a>
<br>
<small>
Infraestructura, Stefanini
</small></p></li>
<li><p><strong>Darío Correal, ing.</strong>
<br>
· <img src="images/github.svg" class="inline_icon" width="16" height="16" alt="GitHub icon" />
<a href="https://github.com/e_dcorreal">e_dcorreal</a>
<br>
<small>
Arquitecto TI, Stefanini
</small></p></li>
</ul>
<hr />
<h1 id="fase-2-soa-objetivo-fna">Fase 2: SOA Objetivo FNA</h1>
<h1 id="contenido-de-los-productos-contractuales-181-2020">Contenido de los Productos Contractuales, 181-2020</h1>
<p><br></p>
<h1 id="producto-5-pr5.-comparativa-de-la-industria-y-el-fna">Producto 5: PR5. Comparativa de la industria y el FNA</h1>
<p>Describir y comparar con el Fondo la manera cómo las empresas del segmento y de otros sectores de la industria enfrentan los retos de flexibilidad de negocio, independencia de proveedor tecnológico, y fortaleza SOA.</p>
<p><strong>Nota</strong>: los análisis de este producto provienen únicamente de los objetivos del proyecto SOA: dependencia de proveedor (OBJ1), fortaleza SOA de las aplicaciones (OBJ2), y el tiempo de mercado (OBJ3).</p>
<p><br></p>
<h2 id="justificación">Justificación</h2>
<p>La comparativa SOA de la industria proveerá al Fondo de hallazgos aplicables a sus procesos y productos. A la vez, esta información de guía puede ser traducida en futuras iniciativas pertenecientes a la hoja de ruta de mejora, tanto del gobierno como de los procesos SOA del Fondo.</p>
<h2 id="contenidos">Contenidos</h2>
<ol type="1">
<li>Arquitectura SOA</li>
<li>Portafolio de servicios</li>
<li>Gobierno SOA</li>
<li>Versionamiento de servicios</li>
<li>Monitoreo y operación SOA</li>
<li>Mantenimiento y evolución de servicios</li>
<li>Nuevas tecnologías</li>
</ol>
<p><br></p>
<h2 id="criterios-de-aceptación">Criterios de Aceptación</h2>
<ul>
<li>Lista de oportunidades e iniciativas ralizables por el FNA</li>
<li>Mejoras visibles para las capacidades de la arquitectura SOA del Fondo</li>
</ul>
<hr />
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Comparativa de la industria y el FNA: <strong>Comparación SOA FNA - Sector</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Situación actual, Comparativa, Industria financiera</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td>9b3a97c del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">N003a Vista Segmento SOA FNA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h1 id="comparación-soa-fna---sector">Comparación SOA FNA - Sector</h1>
<p>Para presentar este análisis comparativo hemos selecionado algunas dimensiones que facilitan la presentación de la comparación en categorías.</p>
<p>Los aspectos a tener en cuenta en la comparativa son:</p>
<ol type="1">
<li>Arquitectura SOA</li>
<li>Portafolio de Servicios</li>
<li>Gobierno SOA</li>
<li>Estrategia de Versionamiento</li>
<li>Monitoreo y Operación</li>
<li>Mantenimiento y Evolución</li>
<li>Nuevas tecnologías</li>
</ol>
<p><br></p>
<p>Presentaremos cada uno de estos aspectos desde el sector financiero en general y; posteriormente serán aplicados al FNA.</p>
<p><br></p>
<h2 id="arquitectura-soa">Arquitectura SOA</h2>
<h3 id="descripción">Descripción</h3>
<p>En esta categoría comparativa establecemos como criterios las prácticas asociadas al manejo de los modelos de arquitectura SOA. En este se encuentran consideraciones como si se cuenta con un depósito de arquitectura formal y un grupo de gobierno y desarrollo de la Arquitectura SOA dentro de la organización. Esto último incluye a los cargos y el nivel de formalismo en realizar y mantener las arquitectura SOA en el Fondo.</p>
<h3 id="prácticas-del-sector-financiero">Prácticas del Sector Financiero</h3>
<p>Depoósito de arquitectura
Análisis de modelos de arquitectura
Herramientas de modelado de arquitecturas de servicios</p>
<h3 id="comparativa-fna">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Depósito de arquitectura</td>
<td>Mega y Archimate</td>
<td></td>
<td>- Herramientas de AE como habilitadores, sin embargo documentando lo necesario bajo enfoques de tipo: MVA (Minimum Viable Architecture) y JITA (Just In Time Architecture) -GitHub</td>
</tr>
<tr class="even">
<td>Análisis de modelos de arquitectura</td>
<td></td>
<td>- Optimización de recursos - Buscar funcionalidades comunes - Elasticidad - Gestión de recursos y seguridad - Prescripción de modelos con base en casuistíca</td>
<td>Enfoque interno donde hay un enfoque donde se promueve el reuso por capacidades comunes: sistemas compartidos, componentes compartidos, plataformas compartidas, codigo compartido</td>
</tr>
<tr class="odd">
<td>Herramientas de modelado de arquitecturas de servicios</td>
<td>Integration Designer IBM, Archimate</td>
<td></td>
<td>Utilización de lenguajes estandarizados, sin atarse a una herramienta especifica</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="portafolio-de-servicios">Portafolio de Servicios</h2>
<h3 id="descripción-1">Descripción</h3>
<p>Esta categoría busca establecer un comparativo entre el las prácticas del FNA y de la industria relacionadas con el manejo de los servicios y el manejo de su portafolio. Herramientas relacionadas para su gestión, registro, búsqueda y documentación.</p>
<h3 id="prácticas-del-sector-financiero-1">Prácticas del Sector Financiero</h3>
<p>Herramientas para el manejo del portafolio de servicios
Gobierno del portafolio de servicios</p>
<h3 id="comparativa-fna-1">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Herramientas para el manejo del portafolio de servicios</td>
<td>Archimate</td>
<td>- API Market - APIGateway</td>
<td>API Gateway</td>
</tr>
<tr class="even">
<td>Gobierno del portafolio de servicios</td>
<td>Arquitectura de aplicaciones oficina de informática fondo nacional del ahorro</td>
<td></td>
<td>Definición de practicas internas basadas en microservicios: - Principio de una sola responsabilidad - Tener un repositorio de datos para cada microservicio - Utilizar la comunicación asíncrona para lograr un acoplamiento flexible - Fallos rápidos mediante un disyuntor para lograr tolerancia a fallos - Proxy de las solicitudes de microservicios a través de una pasarela API - Asegurar que los cambios en la API son compatibles con versiones anteriores - Versionar microservicios para cambios disruptivos - Disponer de una infraestructura dedicada para alojar su microservicio - Crear un “tren de liberación” independiente - Crear eficacia organizativa</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="gobierno-soa">Gobierno SOA</h2>
<h3 id="descripción-2">Descripción</h3>
<p>Esta categoría busca comparar las mejores prácticas de gobierno SOA en el sector y en el FNA. Este item se relaciona de forma directa con el punto de portafolio de servicios pero va mas allá. En esta categoría se establecen criterios como políticas, guías y procedimientos asociados a la dirección de la arquitectura de servicios de la organización.</p>
<h3 id="mejores-prácticas-en-el-sector">Mejores prácticas en el sector</h3>
<p>Comité de arquitectura
Políticas y lineamientos
Arquitectura de referencia
Toma de decisión
Priorización de servicios</p>
<h3 id="comparativa-fna-2">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Comité de arquitectura</td>
<td>No existe formalmente</td>
<td></td>
<td>Comité conformado donde se involucran todos los especialistas, con un enfoque de la “solución” es lo primordial.</td>
</tr>
<tr class="even">
<td>Políticas y lineamientos</td>
<td>Arquitectura de aplicaciones oficina de informática fondo nacional del ahorro</td>
<td>Orentación a procesos y automatización</td>
<td>Claramente establecidos, de conocimiento publico y en constante evolución. - Innersource: “Desarrollo de aplicaciones empresariales con prácticas de código abierto”</td>
</tr>
<tr class="odd">
<td>Arquitectura de referencia</td>
<td>- Bus de servicios de Entidad (ESB). - Arquitectura de referencia SOA</td>
<td>- Service mesh - Domain driven Design - REST - GraphQL - Cloud computing</td>
<td>Uso de arquitecturas de referencia con un enfoque proactivo más que reactivo. Donde se busca que la mejor documentación se encuentre en el futuro propuesto. - Cloud Computing - Microservicios - Arquitectura orientada a eventos - Event-Driven Architectures (EDA) - Serverless - Service mesh</td>
</tr>
<tr class="even">
<td>Toma de decisión</td>
<td>Fragmentados en silos</td>
<td>metodología SGMM (SOA Governance and Management Method)</td>
<td>Decisiones de arquitectura basadas al tener en cuenta diferentes perspectivas pasando desde el negocio a lo técnico.</td>
</tr>
<tr class="odd">
<td>Priorización de servicios</td>
<td>Orientado por necesidades de área de negocio</td>
<td></td>
<td>Enfoque desde el punto de vista de minimizar los “Riesgos para el negocio”</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="estrategia-de-versionamiento">Estrategia de Versionamiento</h2>
<h3 id="descripción-3">Descripción</h3>
<p>Esta categoría busca establecer los mecanismos, herramientas y mejores prácticas relacionadas con el manejo de las versiones de los servicios.</p>
<p><br></p>
<h3 id="prácticas-del-sector-financiero-2">Prácticas del Sector Financiero</h3>
<p>Manejo de la gestión del cambio
Herramientas para documentación y gestión de las versiones de servicios
Documentación de los servicios y sus versiones</p>
<p><br></p>
<h3 id="comparativa-fna-3">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Manejo de la gestión del cambio</td>
<td>Definida al interior de la organización</td>
<td></td>
<td>API Gateway, con versiones para cada cambio</td>
</tr>
<tr class="even">
<td>Herramientas para documentación y gestión de las versiones de servicios</td>
<td></td>
<td></td>
<td>Swagger, MadCap Flare</td>
</tr>
<tr class="odd">
<td>Documentación de los servicios y sus versiones</td>
<td>Definida al interior de la organización. No centralizada, ni alineada a un gobierno</td>
<td></td>
<td>OpenAPI, Swagger</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="monitoreo-y-operación">Monitoreo y Operación</h2>
<h3 id="descripción-4">Descripción</h3>
<p>Esta categoría analiza las diferentes herramientas, mecanismos y mejores prácticas relacionadas con el monitoreo y operación de los servicios en operación.</p>
<h3 id="prácticas-del-sector-financiero-3">Prácticas del Sector Financiero</h3>
<p>Herramientas utilizadas para gestionar el despliegue y operación de los servicios
Herramientas para monitoreo de la operación, gestión de alarmas y notificaciones</p>
<h3 id="comparativa-fna-4">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Herramientas utilizadas para gestionar el despliegue y operación de los servicios</td>
<td>IBM Jazz</td>
<td>GitLAB CI</td>
<td>Jenkins, herramientas del proveedor de nube, kubernetes</td>
</tr>
<tr class="even">
<td>Herramientas para monitoreo de la operación, gestión de alarmas y notificaciones</td>
<td>Herramientas para monitoreo a nivel de Infraestructura</td>
<td>New Relic</td>
<td>herramientas del proveedor de nube</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="mantenimiento-y-evolución">Mantenimiento y Evolución</h2>
<h3 id="descripción-5">Descripción</h3>
<p>Esta categoría analiza las estrategias recomendadas para favorecer el mantenimiento y evolución de los servicios. Es decir la capacidad de la organizacón de poder mantener, mejorar, corregir y evolucionar los servicios de la organización.</p>
<h3 id="prácticas-del-sector-financiero-4">Prácticas del Sector Financiero</h3>
<p>Gestión del cambio
Manejo de solicitudes de cambio
Gestión de prioridades para los cambios
Gestión de inconformidades y defectos</p>
<h3 id="comparativa-fna-5">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gestión del cambio</td>
<td>Comité de cambios</td>
<td>PI Planning , Oficina Agile</td>
<td>Enfoque en “reducción del riesgo”</td>
</tr>
<tr class="even">
<td>Manejo de solicitudes de cambio</td>
<td>Procedimiento interno</td>
<td></td>
<td>Implementación de microservicios con separación de lógica y responsabilidades</td>
</tr>
<tr class="odd">
<td>Gestión de prioridades para los cambios</td>
<td>Comité de cambios</td>
<td></td>
<td>Service Design: diseñar la experiencia orquestada de todos los puntos de contacto del servicio.</td>
</tr>
<tr class="even">
<td>Gestión de inconformidades y defectos</td>
<td>Procedimiento interno</td>
<td></td>
<td>El principio de “sala blanca”(clean room) se centra en la prevención de defectos</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="nuevas-tecnologías">Nuevas tecnologías</h2>
<h3 id="descripción-6">Descripción</h3>
<p>En esta categoria se analizan las prácticas del FNA comparadas con la industria en temas relacionados con la vigilancia de nuevas tecnologías asociadas a servicios, así como las políticas de renovación y adopción de dichas tecnologías.</p>
<h3 id="prácticas-del-sector-financiero-5">Prácticas del Sector Financiero</h3>
<p>Políticas de vigilancia
Laboratorios para experimentación de nuevas tecnologías
Capacitación y entrenamiento
Plan programado de adopción y migracións</p>
<h3 id="comparativa-fna-6">Comparativa FNA</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Práctica</strong></th>
<th><strong>Estado FNA</strong></th>
<th><strong>Estado Entidad Bancaria líder en Hispanomericana (BBVA)</strong></th>
<th><strong>Estado Entidad Bancaria líder mundial (Capital One)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Políticas de vigilancia</td>
<td>No existe formalmente</td>
<td>‘Reinventar la empresa en la era digital’</td>
<td>Observación del mercado, revisión interna y constante experimentación</td>
</tr>
<tr class="even">
<td>Laboratorios para experimentación de nuevas tecnologías</td>
<td></td>
<td>BBVA Next Technologies</td>
<td>Equipo interno con orientación centrada al cliente, API abierta a integración con terceros, hackatons, iteraciones y prototipados agiles</td>
</tr>
<tr class="odd">
<td>Capacitación y entrenamiento</td>
<td></td>
<td>Política de certificación con aliados claves de tecnología</td>
<td>Presupuesto interno para estimular el crecimiento academico, adicional hay enfoque en proyectos personales</td>
</tr>
<tr class="even">
<td>Plan programado de adopción y migraciones</td>
<td></td>
<td></td>
<td>Politica de salida a producción completamente automatizada, bajo el principio de “Sala blanca”, donde el proceso garantiza que no hay dudas sobre lo que sale a producción</td>
</tr>
</tbody>
</table>
<h1 id="fase-2-soa-objetivo-fna-1">Fase 2: SOA Objetivo FNA</h1>
<h1 id="contenido-de-los-productos-contractuales-181-2020-1">Contenido de los Productos Contractuales, 181-2020</h1>
<h1 id="producto-6-pr6.-gobierno-soa">Producto 6: PR6. Gobierno SOA</h1>
<p>El gobierno SOA es el encargado de vigilar las relaciones entre las áreas de negocio incluidas en el segmento FNA del presente diagnóstico (la vicepresidencia de operaciones y la vicepresidencia de crédito del FNA) y la implementación y diseño de soluciones SOA. El modelo de gobierno SOA para el Fondo debe asistir en la aplicación y ejecución de un régimen (estándar) de implementación, observación y puesta en marcha de soluciones SOA.</p>
<p><strong>Nota</strong>: los análisis de este producto están dirigidos a cumplir los objetivos del proyecto SOA: dependencia de proveedor (OBJ1), fortaleza SOA de las aplicaciones (OBJ2), y tiempo de mercado (OBJ3).</p>
<p><br></p>
<h2 id="justificación-1">Justificación</h2>
<p>El cierre de brechas de alineación negocio FNA-SOA (Ver PR9. Portafolio de inciativas y brechas) es una de las principales razones por las que implementar el modelo de gobierno SOA. Pero no es la única. El gobierno también debe demostrar los beneficios de aumentar el nivel de eficacia (madurez) SOA, tanto en el segmento FNA seleccionado por este diagnóstico como a todo el Fondo. Por último, el gobierno SOA funciona como una disciplina para hacer frente a los retos futuros con una mirada en la inversión de tecnología, los riesgos operativos y en la alineación con el negocio del FNA.</p>
<h2 id="contenidos-1">Contenidos</h2>
<ol type="1">
<li>Definición de objetivos y capacidades del gobierno SOA</li>
<li>Equilibrio arquitectura y procesos SOA</li>
<li>Supervisión de efectividad y factibilidad SOA</li>
<li>Mejora de los índices de efectividad (madurez) SOA</li>
<li>Consideraciones para la puesta en marcha del gobierno SOA en el FNA</li>
</ol>
<p><br></p>
<h2 id="criterios-de-aceptación-1">Criterios de Aceptación</h2>
<ul>
<li>Objetivos y capacidades del gobierno SOA para el Fondo</li>
<li>Índices de efectividad (madurez) SOA 1</li>
</ul>
<hr />
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Gobierno SOA: <strong>Definición de objetivos del gobierno SOA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Situación actual, Capacidades de negocio</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Fase 2 PR6 Gobierno SOA</a></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th><br></th>
<th>Tema</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<h2 id="definición-de-objetivos-del-gobierno-soa">Definición de objetivos del gobierno SOA</h2>
<p>Dado los niveles de complejidad que el FNA ha alcanzado y por los riesgos tecnológico que contraen las partes analizadas en la Fase 1 de este diagnóstico (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">04b.Resumen Fase 1</a>), esto es, aplicaciones, servicios, procesos, infraestructura, entre otros, la figura de gobierno SOA es de carácter obligatorio en el Fondo. Esta sirve además para complementar los procedimientos de TI del Fondo (ver anexo 1, <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">06n. Anexos</a>).</p>
<p>De las problemáticas encontradas en la Fase 1 del presente diagnóstico, nos estamos refiriendo explícitamente a las que incrementan la complejidad de las herramientas de software y soluciones tecnológicas del FNA, <em>como lo es el manejo de dependencias de los servicios SOA del Fondo</em>. Es muy conocido, y demostrado, que solo esta condición es la causa de la mayoría de los sobreesfuerzos en los cambios y de la dificultades a la hora de predecir su impacto.</p>
<p>Junto a esta complicación, que de por sí hace obligatoria la introdución de la figura del gobierno SOA en el Fondo, y que organizaciones como el OpenGroup señalan que se dan por la falta de Arquitectura Empresarial, y por consiguiente, por un débil gobierno, se encuentran otras que fueron levantadas en la Fase 1 del presente diagnóstico: agilidad limitada, complejidad e imprecisión en la trazabilidad, ocultamiento de funcionalidades (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">04b.Resumen Fase 1</a>).</p>
<p><br></p>
<h3 id="objetivos-principales-del-gobierno-soa-del-fna">Objetivos Principales del Gobierno SOA del FNA</h3>
<p>Una vez identificadas estas problemáticas de orden mayor existentes en la empresa y que podemos resumir en tres: riesgo tecnológico, complejidad y nivel de adopción SOA presente en los desarrollos e implementaciones del FNA, el gobierno SOA propuesto para el Fondo debe incluir entre sus objetivos, como mínimo, los siguientes</p>
<p><img src="images/GobiernoSOA.3n.png" />
<a href="">Imagen.</a> Objetivos principales del gobierno SOA del FNA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<ol type="1">
<li>Vigilancia del riesgo tecnológico en tres vías. Primero, hacer seguimiento a la inversión tecnológica, el cual involucra a los provedores del FNA y colaboración con externos; segundo, evaluar y constatar la implementación de herramientas de software, la cual podría limitarse a servicios SOA; y finalmente, controlar la adopción de nuevos diseños, nuevos marcos de trabajo, librerías o componentes de terceros.</li>
<li>Del objetivo anterior (Vigilancia del riesgo tecnológico) se desprende este para enfatizar el control sobre la inversión de TI: vigilar la efectividad y factibilidad de los proyectos SOA de la organización en términos del área de efectividad del costo y factibilidad SOA. Ambos conceptos explicados en <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Supervisión de efectividad y factibilidad SOA</a>.</li>
<li>Vigilar el crecimiento de la complejidad y el impacto de los nuevos cambios en la arquitectura de referencia SOA del Fondo, bien sea por medio de las revisiones de diseño, el comité de arquitectura, o por el desarrollo y distribución de un catálogo de soluciones preconstruídas que alivie y guíe a las fábricas y desarrolladores que trabajan para la empresa.</li>
<li>Vigilar y perseguir el aumento de los índices de adopción, adaptación y efectividad SOA presentes en los análisis de madurez como el realizado en la Fase 1 del diagnóstico presente (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">02.Fase 2 PR2 Estudio Madurez SOA FNA</a>).</li>
<li>Poner el marcha el proceso de gobierno SOA del FNA descrito más adelante en este ejercicio (181-2020). Adaptar y monitorear los índices de rendimiento (KPI) del proceso.</li>
</ol>
<p><br></p>
<h3 id="otros-objetivos-del-gobierno-soa">Otros Objetivos del Gobierno SOA</h3>
<p>Para complementar la lista de objetivos del gobierno SOA recomendados por este diagnóstico al Fondo, la lista siguiente expone objetivos que pueden ser conseguidos de forma indirecta, o con la mediación de proyectos transformadores, como la Arquitectura Empresarial, transformación digital, arquitectura de negocio, entre otros.</p>
<ol type="1">
<li>Desde el área, o rol, de gobierno SOA del FNA, servir de guía en la entrega de soluciones de software conforme a la arquitectura de referencia estregada por esta consultoría.</li>
<li>Informar de desviaciones en la relación de efectividad de costos de los proyectos SOA del FNA (en términos del área de inefectividad de costo e infactibilidad SOA.</li>
<li>Hacer el seguimiento de las implementaciones de los cambios en la arquitectura de referencia: phase G, Implementation Governance, TOGAF ADM.</li>
</ol>
<p><br></p>
<p><img src="images/GobiernoSOA.3n-2.png" />
<a href="">Imagen.</a> Objetivos secundarios del gobierno SOA del FNA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Gobierno SOA: <strong>Riesgos tecnológicos del FNA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Gobierno, Riesgo, Objetivos de negocio</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Fase 2 PR6 Gobierno SOA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="riesgos-tecnológicos-del-fna">Riesgos Tecnológicos del FNA</h2>
<p>Los riesgos tecnológicos encontrados en el diagnóstco SOA de Fase 1 (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">03.Fase 1 PR3 Resultado Diagnóstico Situación Actual</a>), y que describimos abajo, están incorporados a las vigilancias del gobierno SOA propuesto. A la vez, estos mismos riesgos descritos a continuación deben ser agregados a la matriz de gestión actual del Fondo, y gestionados por los métodos propios con los que ya cuenta el FNA.</p>
<p><br></p>
<h3 id="gobierno-soa-y-riesgos-tecnológicos-del-fna">Gobierno SOA y Riesgos Tecnológicos del FNA</h3>
<p>El gobierno SOA del FNA debe buscar la capacidad para medir y gestionar (agregar a la lista de riesgos de la empresa) los riesgos que lo están afectando.</p>
<ul>
<li>R1. Riesgo de agilidad limitada (ver imagen 1)</li>
<li>R2. Riesgo de baja orquestación SOA (ver imagen 2a y 2b)</li>
<li>R3. Riesgo de crecimiento de dependencias entre servicios SOA</li>
<li>R4. Riesgo de crecimiento de adaptadores particulares –opuesto al estándar– (ver imagen 3)</li>
<li>R5. Riesgo de baja reutilización de servicios SOA</li>
<li>R6. Riesgo de permanencia de aplicaciones silos</li>
<li>R7. Riesgo de falta de trazabilidad para la evolución e implementación de los servicios SOA</li>
</ul>
<p><br></p>
<figure>
<img src="images/ESB-IBM.png" />
</figure>
<p><a href="">Imagen 1.</a> Riesgo no. 1 y 2. Agilidad limitada por el proliferación de la copmlejidad en los servicios SOA del Fondo.</p>
<p><em>Fuente: elaboración propia, ae_fna_as_is.archimate.</em></p>
<p><br></p>
<figure>
<img src="images/esb-procesos.png" />
</figure>
<p><a href="">Imagen 2a.</a> Riesgo no. 2. En el modelo “ae_fna_as_is.archimate” de situación actual del FNA no aparecen relaciones de este con los procesos de negocio. La principal utilización del bus (ESB-IBM, en la imagen) está destinada a la integración de aplicaciones.</p>
<p><em>Fuente: ae_fna_as_is.archimate.</em></p>
<p><br></p>
<figure>
<img src="images/ESB-IBM-2.png" />
</figure>
<p><a href="">Imagen 2b.</a> En el modelo “ae_fna_as_is.archimate” no es posible encontrar relaciones del bus con los procesos.</p>
<p><em>Fuente: ae_fna_as_is.archimate.</em></p>
<p><br></p>
<figure>
<img src="images/CRM.png" />
</figure>
<p><a href="">Imagen 3.</a> Riesgo no. 4 y 5. Caso de CRM del FNA. Le afecta el riesgo de estándarización en la interoperabilidad, aumenta la cantidad de adaptadores particulares.</p>
<p><em>Fuente: ae_fna_as_is.archimate.</em></p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Gobierno SOA: <strong>Capacidades FNA por Desarrollar para el Gobierno SOA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Situación actual, Capacidades de negocio</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Fase 2 PR6 Gobierno SOA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="capacidades-fna-por-desarrollar-para-el-gobierno-soa">Capacidades FNA por Desarrollar para el Gobierno SOA</h3>
<p>Las capacidades requeridas por el gobierno SOA del Fondo, que a la vez soportan a la matriz de roles y responsabilidades (RACI) futuras del equipo de gobierno SOA o del Comité de arquitectura del Fondo están relacionados directamente con los objeitvos del gobierno SOA y con los riesgos tecnológicos encontrados en la Fase 1 (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">06a.Objetivos gobierno</a>, y <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">06c.Riesgos tecnológicos SOA</a>).</p>
<p><br></p>
<blockquote>
<p><strong>Nota</strong>: no es del alcance de esta consultoría, E-Service (contrato 181-2020), desarrollar estas capacidades. Esto requeriría de la ejecución de otro(s) proyecto. El Fondo podría desarrollar estas capacidades indicadas por este diagnóstico de forma interna, o contratar proyectos para la creación y gestión de estas capacidades.</p>
</blockquote>
<p><br></p>
<figure>
<img src="images/capacidades.png" />
</figure>
<p><a href="">Imagen 1.</a> TOGAF 9, Fase G, Implementation governance para la implementación de las capacidades de ejecución de hojas de ruta del FNA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<ol type="1">
<li>CAP1. Realizar e implementar estrategias y entregables para planear y analizar la arquitectura de referencia SOA del Fondo (resultado Fase 2 de este diagnóstico).</li>
<li>CAP2. Relacionar elementos de la arquitectura de referencia SOA (181-2020), esto es, procesos de negocio, servicios, datos, aplicaciones, componentes, tecnologías, etc., y vincular distintas perspetivas a una vertical de negocio del Fondo, como, Gestión Comercial, Cesantías, Ahorro Voluntario para desarrollar modelos consistentes y desarrollar la oportunidad de dirigir cambios y atacar los problemas de integralidad de las pruebas.</li>
<li>CAP3. Realizar y gestionar la puesta en marcha de hojas de ruta para cerrar brechas y alcanzar estados futuros de la arquitectura (TOGAF 9, Fase G, Implementation governance). Ver anexo 1.</li>
<li>CAP4. Ejercitar la trazabilidad de los activos y productos de TI con los productos y decisiones de negocio de las áreas del FNA, como la vicepresidencia de Crédito y la de Operaciones ante la llegada de impactos, cambios, reformas y bajas tecnológicas.</li>
<li>CAP5. Realizar análisis de impacto, riesgos, costo beneficio, capacidad usada, y gestión de demanda ante la evaluación de cambios a la arquitectura de referencia SOA y activos de TI, cuando lo amerite.</li>
<li>CAP6. Emitir y gestionar los contenidos de documentación técnica, como principios, restricciones tecnológicas, marcos de trabajo, normas, diseños, y estándares para el uso de los proveedores, servicios de fábricas del FNA, planta interna, Comunicación y Planeación.</li>
<li>CAP7. Emitir y actualzar el marco de trabajo de gobierno SOA que complemente el de TI del Fondo y que enuncie los procesos, procedimientos y responsabilidades de este con el fin de generar la autoridad y asistir en la toma de deciones internas (áreas de TI y Planeación del Fondo) y externas (proveedores del Fondo)</li>
</ol>
<p><br></p>
<h3 id="anexo-1.-proceso-de-arquitectura-empresarial">Anexo 1. Proceso de Arquitectura Empresarial</h3>
<figure>
<img src="images/adm.gif" />
</figure>
<p><a href="">Imagen 2.</a> TOGAF 9, Fase G, Implementation governance para la implementación de las capacidades de ejecución de hojas de ruta del FNA.</p>
<p><em>Fuente: www.opengroup.org/soa/source-book/togaf.</em></p>
<h1 id="contenido">Contenido</h1>
<p><a href="#tabla-de-ilustraciones">2 Tabla de Ilustraciones
[1](#tabla-de-ilustraciones)</a></p>
<p><a href="#introducción">3 Introducción [2](#introducción)</a></p>
<p><a href="#alcance">4 Alcance [3](#alcance)</a></p>
<p><a href="#antecedentes-política-pública-y-normativa">5 Antecedentes Política Pública y Normativa
[3](#antecedentes-política-pública-y-normativa)</a></p>
<p><a href="#marco-teórico">6 Marco teórico [6](#marco-teórico)</a></p>
<p><a href="#definición-de-gobierno-de-datos">6.1 Definición de Gobierno de Datos
[6](#definición-de-gobierno-de-datos)</a></p>
<p><a href="#_Toc110853530">6.2 Marco de Trabajo de Gobierno de Datos
[7](#_Toc110853530)</a></p>
<p><a href="#modelo-de-gobierno-propuesto">7 Modelo de Gobierno
[9](#modelo-de-gobierno-propuesto)</a></p>
<p><a href="#articulación">7.1 Articulación [10](#articulación)</a></p>
<p><a href="#horizontal">7.1.1 Horizontal [10](#horizontal)</a></p>
<p><a href="#centrado-en-la-persona">7.1.2 Centrado en la persona
[10](#centrado-en-la-persona)</a></p>
<p><a href="#vertical">7.1.3 Vertical [11](#vertical)</a></p>
<p><a href="#política">7.2 Política [11](#política)</a></p>
<p><a href="#ejes">7.3 Ejes [12](#ejes)</a></p>
<p><a href="#componentes">7.4 Componentes [12](#componentes)</a></p>
<p><a href="#modelo-operativo">7.5 Modelo Operativo [13](#modelo-operativo)</a></p>
<p><a href="#comité-gobierno-de-datos">7.6 Comité Gobierno de datos
[14](#comité-gobierno-de-datos)</a></p>
<p><a href="#roles-y-funciones">7.7 Roles y Funciones [16](#roles-y-funciones)</a></p>
<p><a href="#_Toc110853542">8 Referencias [19](#_Toc110853542)</a></p>
<h1 id="tabla-de-ilustraciones">Tabla de Ilustraciones</h1>
<p><a href="#_Toc110619194">Ilustración 1 Política Pública y Normativa
[3](#_Toc110619194)</a></p>
<p><a href="file:///C:/Users/ASUS/Downloads/5_Modelo_Gobierno_DatosV2.docx#_Toc110619195">Ilustración 2: Definición y Beneficios del Gobierno de Datos
[7](#_Toc110619195)</a></p>
<p><a href="file:///C:/Users/ASUS/Downloads/5_Modelo_Gobierno_DatosV2.docx#_Toc110619196">Ilustración 3: Pilares de un Marco de Trabajo para el Gobierno de Datos
[8](#_Toc110619196)</a></p>
<p><a href="#_Toc110619197">Ilustración 4: Modelo de Gobierno de Datos
[9](#_Toc110619197)</a></p>
<p><a href="file:///C:/Users/ASUS/Downloads/5_Modelo_Gobierno_DatosV2.docx#_Toc110619198">Ilustración 5 Estructura Federada de Gobierno de Datos
[14](#_Toc110619198)</a></p>
<p><a href="#_Toc110619199">Ilustración 6 Comité Gobierno de Datos
[15](#_Toc110619199)</a></p>
<p><a href="#_Toc82980949">Ilustración 7: Roles de gobierno de datos
[18](#_Toc82980949)</a></p>
<h1 id="introducción">Introducción</h1>
<p>El Gobierno nacional aprobó el documento CONPES 3920 de 2018 que define
la política de explotación de datos (Big Data) para el Estado
colombiano. Con este documento, el país asume el liderazgo regional al
ser el primero en Latinoamérica, y octavo en el mundo, con una política
pública integral que habilita el aprovechamiento de los datos para
generar desarrollo social y económico. [1]</p>
<p>El gobierno de datos es necesario para la explotación de datos teniendo
en cuenta la arquitectura del modelo de explotación de datos; este
instrumento permite identificar en las entidades las capacidades
organizacionales y en <strong>recurso humano, tecnológico y financiero</strong> que
deben desarrollar para mejorar el aprovechamiento de datos y, a su vez,
visibilizar el efecto que tiene la explotación y la analítica de datos
para generar valor público a partir de la optimización en la prestación
de bienes y servicios a los ciudadanos, mejorar la eficiencia en la
gestión pública, y diseñar políticas públicas basadas en evidencia.
[2]</p>
<p>La elaboración de este documento se realizó mediante el análisis de los
principales marcos de trabajo para la gestión de datos (MINTIC, DAMA,
IBM) que existen en la actualidad, por parte de los integrantes del
equipo del Fondo Nacional del Ahorro se tuvieron en cuenta los
siguientes factores representativos de la entidad: su estructura
organizativa, cultura, nivel de madurez en el gobierno de datos, apoyo
del nivel directivo, entre otros.</p>
<p>Los lineamientos y definiciones propuestos en este documento se basan en
la política pública, la normativa que hasta la fecha se ha expedido y la
guía del Ministerio De Tecnología de la Información y las Comunicaciones
(en adelante MINTIC) “G.INF.06 Guía Técnica de Información - Gobierno
del dato”, la cual contempla los datos desde la perspectiva de
componentes de información (CI).</p>
<h1 id="alcance">Alcance</h1>
<p>Definir un modelo de gobierno de datos de alto nivel que sirva de guía a
las demás funciones de gestión de datos, para mejorar los procesos de
toma de decisiones al momento de priorizar las inversiones, asignar
recursos, medir los resultados y conocer cómo los datos se gestionan y
despliegan de forma adecuada, para el apoyo continúo a las necesidades
de la ciudadanía y para aportar al cumplimiento de los objetivos de cada
una de las dependencias, departamentos y gerencias del Fondo Nacional
del Ahorro.</p>
<h1 id="antecedentes-política-pública-y-normativa">Antecedentes Política Pública y Normativa</h1>
<figure>
<img src="./images/gobd1/media/image1.png" style="width:6.00417in;height:3.09097in" />
</figure>
<p><span id="_Toc110619194" class="anchor"></span>Ilustración 1 Política Pública y Normativa</p>
<p>El documento CONPES 3920 de 2018 “Política Nacional De Explotación De
Datos (Big Data)” estableció la necesidad de diseñar e implementar la
infraestructura de datos, al ser los datos activos que generan valor
económico y social, que requieren su definición, implementación,
mantenimiento y explotación a partir de la infraestructura de datos.</p>
<p>El Documento CONPES 3975 de 2019, "Política Nacional para la
Transformación Digital e Inteligencia Artificial”, establece que
Colombia debe seguir desarrollando una infraestructura de datos completa
y que permita el diseño e implementación de sistemas de IA en el país,
priorizando la creación e identificación de bases de datos masivos que
sean interoperables y contengan información estructurada, así como
disminuyendo barreras innecesarias e injustificadas al acceso a datos,
para los desarrolladores de esta tecnología.</p>
<p>El Documento CONPES 3995 de 2020, “Política Nacional de Confianza Y
Seguridad Digital”, señala como un objetivo establecer medidas para
desarrollar la confianza digital a través de la mejora en la seguridad
digital de manera que Colombia sea una sociedad incluyente y competitiva
en el futuro digital mediante el fortalecimiento de capacidades y la
actualización del marco de gobernanza en seguridad digital, así como con
la adopción de modelos con énfasis en nuevas tecnologías.</p>
<p>“Finalmente, en respuesta al CONPES 3920 -2018 se incorpora en la
Política de Gobierno Digital uno de los componentes esenciales para
asegurar la transformación digital del Estado denominado como el Modelo
de implementación de Explotación de Datos que permite que las entidades
evalúen sus capacidades organizacionales y en recurso humano,
tecnológico y financiero para la explotación de datos. A la vez que
proporciona insumos para construir una hoja de ruta para mejorar
estas capacidades. ​</p>
<p>Una mayor madurez de las capacidades para la explotación de datos de la
entidad permitirá que se implementen procesos de analítica de datos y
bigdata, como base para la implementación de iniciativas basadas en
tecnologías emergentes”</p>
<p>El documento CONPES 4023 de 2021, “Política para la Reactivación, la
Repotenciación y el Crecimiento Sostenible e Incluyente: Nuevo
Compromiso por el Futuro de Colombia”, establece que la consolidación de
la infraestructura de datos en el país carece de un marco de gobernanza
que articule las políticas, normativas y lineamientos para
la disponibilidad, intercambio y reutilización de datos y que permita su
sostenibilidad en el largo plazo.</p>
<p>​</p>
<p>El Ministerio de Tecnologías de la Información y las Comunicaciones
(MinTIC) para el presente año (2022) ha expedido normativa:</p>
<p>La Resolución 460 de 2022, Plan Nacional de Infraestructura de Datos
(PNID) y su Hoja de Ruta, con el fin de impulsar la transformación
digital del Estado y el desarrollo de una economía basada en los datos.</p>
<p>El Decreto 767 de 2022 - El numeral 4 del artículo 2.2.9.1.2.1 Decreto
1078 de 2015, Decreto Único Reglamentario del Sector de Tecnologías
de la Información y las Comunicaciones, establece como uno de los
elementos que componen la estructura de la Política de Gobierno Digital,
la línea de acción denominada “Decisiones basadas en datos”, la
cual busca promover el desarrollo económico y social del país impulsado
por datos, entendiéndolos como infraestructura y activos estratégicos, a
través de mecanismos de gobernanza para el acceso, intercambio,
reutilización y explotación de los datos, que den cumplimiento a las
normas de protección y tratamiento de datos personales y permitan
mejorar la toma de decisiones y la prestación de servicios de los
sujetos obligados.</p>
<p>Para explotar el potencial que tienen los datos de transformar el actuar
del sector público, resulta fundamental establecer reglas y principios
claros y comunes a todos los actores que intervienen en las etapas
relevantes del ciclo de vida de los datos, desde entidades públicas,
funcionarios públicos, usuarios, sector privado, academia, y demás
actores.</p>
<p>El Decreto 1389 de 2022 que establece los lineamientos generales para la
gobernanza en la infraestructura de datos y se crea el Modelo de
gobernanza de la infraestructura de datos (Componentes, niveles,
instancias, roles y otras disposiciones), Este decreto se articula con
el <a href="https://www.mintic.gov.co/portal/inicio/Sala-de-prensa/Noticias/198952:MinTIC-expide-el-Plan-Nacional-de-Infraestructura-de-Datos-que-impulsara-la-transformacion-digital-del-Estado">Plan Nacional de Infraestructura de
Datos</a>,
establecido a través de la Resolución 460 de 2022 y con la <a href="https://mintic.gov.co/portal/inicio/Sala-de-prensa/Noticias/210461:Ministerio-TIC-expide-el-Decreto-767-del-2022-la-actualizacion-Politica-Colombiana-de-Gobierno-Digital">Política de
Gobierno
Digital</a> actualizada
desde el pasado 16 de mayo con el Decreto 767 de 2022.</p>
<p> </p>
<h1 id="marco-teórico">Marco teórico</h1>
<h2 id="definición-de-gobierno-de-datos">Definición de Gobierno de Datos</h2>
<p>El gobierno de los datos (Data Governance) es la estrategia corporativa
que define la política, los procedimientos, los procesos, las normas,
los responsables y la tecnología que ha de gobernar o regir la
utilización de los datos corporativos para una eficaz gestión de la
información en una organización o empresa. [3]</p>
<p>El objetivo principal en el gobierno de datos es ayudar a maximizar el
valor de los datos dentro de una organización, es decir, obtener el
máximo rendimiento de los datos como un activo primordial de la empresa.
Hoy en día, existen numerosas definiciones de Data Governance [3], a
continuación, se exponen algunas de ellas:</p>
<ul>
<li><p>DAMA (Data Management Association) propone que “el gobierno de datos
es el ejercicio de autoridad y el control (la planificación, el
seguimiento y la aplicación) a través de la gestión de activos de
datos”. [4]</p></li>
<li><p>El Instituto Data Governance (DGI) afirma que "el gobierno de datos
es un sistema de derechos de decisión y rendición de cuentas para
los procesos relacionados con la información, ejecutado según
acuerdos de modelos que describen quién puede tomar las acciones con
que información, cuándo, en qué circunstancias, y con qué métodos".
[5]</p></li>
<li><p>IBM señala que “Data Governance se refiere a cómo una organización
utiliza los datos para beneficiar y proteger a sí mismo.” [6]</p></li>
</ul>
<p>Para el Fondo Nacional del Ahorro la definición entregada por el DAMA
supone la que más se ajusta a la estrategia y realidad institucional,
por lo tanto, es de esta forma que se abordara siempre el concepto de
Gobierno de Datos.</p>
<blockquote>
<figure>
<img src="./images/gobd1/media/image2.png" style="width:7in;height:3.9375in" />
</figure>
</blockquote>
<h2 id="marco-de-trabajo-de-gobierno-de-datos">Marco de Trabajo de Gobierno de Datos</h2>
<p>Un marco de trabajo de gobierno de datos es un conjunto estandarizado de
conceptos, prácticas y criterios, que permite a las organizaciones
administrar los datos de manera organizada y eficiente, esta ayuda se
traduce entre otras en facilitar que todos los actores de la
organización compartan la forma de pensar y comunicarse acerca de
conceptos complicados o ambiguos. Nicola Askham refiere que “No hay un
enfoque único para todos (los marcos de trabajo). Para que funcione,
debe ajustarse a la cultura, estructura y prácticas de la organización.
Una vez dicho esto, los componentes básicos de las políticas, procesos,
roles y responsabilidades se encontrarán en todos los marcos”. [7]</p>
<p>Se destaca en un marco de trabajo de gobierno de datos la comprensión de
los elementos fundamentales:</p>
<ul>
<li><p><strong>Política:</strong> Tener una política que establezca la institución
"hará" que la gestión de datos sea una parte clave del marco. Sin
este, no habrá autoridad para cambiar la forma en que la
organización piensa y maneja los datos. En algunas instancias, se
puede avanzar sin una política cuando la gobernanza de datos es un
enfoque clave, sin embargo, como las prioridades comerciales futuras
cambian, es probable que la iniciativa disminuya o, en el peor de
los casos, se abandone. Tener una política como parte del enfoque de
gestión de datos otorga autoridad, a las partes interesadas.</p></li>
<li><p><strong>Ejes:</strong> Concentrar los esfuerzos en un ámbito específico para
seguir, crear los lineamientos, directrices, guías y procedimientos
definidos y documentados permitiendo tener un enfoque consistente y
repetible para gestionar los datos en toda la organización.</p></li>
<li><p><strong>Modelo Operativo:</strong> Conjunto de elementos que hace posible
materializar el modelo en la entidad.</p></li>
<li><p><strong>Roles y responsabilidades:</strong> El tercer componente vital es definir
quiénes son los responsables de los datos y el alcance de las
responsabilidades.</p></li>
</ul>
<blockquote>
<p>Sobre este último ítem es importante destacar que la gestión de los
datos es una responsabilidad compartida, entre los profesionales de la
gestión de datos (administradores y custodios) dentro de las
organizaciones (TI) y los <strong>propietarios</strong> de datos del negocio
(responsables), que representan los intereses colectivos de los
productores de datos y los consumidores de información.</p>
</blockquote>
<figure>
<img src="./images/gobd1/media/image3.png" style="width:4.40625in;height:3.52222in" />
</figure>
<h1 id="modelo-de-gobierno-propuesto">Modelo de Gobierno Propuesto</h1>
<p>El Fondo nacional del Ahorro es una entidad comprometida con el
mejoramiento de su desempeño y la atención al ciudadano, para lo cual
requiere tomar decisiones y empoderar a la ciudadanía a través de sus
datos e información. Para lograr lo anterior, se prioriza la
administración, mejora y aprovechamiento de datos que se encuentran en
diferentes sistemas de información que apoyan los procesos de las
dependencias direccionamiento estratégico (misionales, apoyo, evaluación
y mejora), todo articulado por medio de la definición de un Sistema
Integrado de Planeación y Gestión (MIPG), con apoyo del direccionamiento
estratégico, las políticas de transparencia y acceso a la información
pública, lucha contra el fraude y la gestión documental.</p>
<figure>
<img src="./images/gobd1/media/image4.png" style="width:7.12136in;height:4.18419in" />
</figure>
<p><span id="_Toc110619197" class="anchor"></span>Ilustración 4: Modelo de Gobierno de Datos</p>
<h2 id="articulación">Articulación</h2>
<h3 id="horizontal">Horizontal</h3>
<p>El propósito de esta dimensión es permitirle a la entidad realizar las
actividades que la conduzcan a lograr los resultados propuestos y a
materializar las decisiones plasmadas en su planeación institucional, en
el marco de los valores del servicio público.</p>
<p>El modelo definido también se articula con los niveles <em>estratégico,
misional, apoyo y de evaluación y mejora continua</em> del modelo de
operación por procesos, con el fin de aprovechar los procesos existentes
en la entidad y facilitar la implementación al tener previamente mapeado
los responsables, actividades, entradas, salidas, herramientas y otros
insumos necesarios para la implementación del modelo de gobierno.</p>
<h3 id="centrado-en-la-persona">Centrado en la persona</h3>
<p>Integrar las personas para que en el horizonte tiempo permanezca la
cultura del dato en la entidad buscando de manera continua el
fortaleciendo de las competencias en las diferentes dimensiones:
saberes, saber ser, saber hacer; mediante la oferta de formación y
capacitación de acuerdo con las temáticas definidas por el plan nacional
de formación adoptado por el plan municipal de capacitación, priorizando
los ejes: <strong>Transformación Digital</strong> enmarcado en el CONPES 3975
(Departamento Nacional de Planeación, 2019) y la <strong>gestión del
conocimiento y la innovación</strong> en todos sus ejes:</p>
<ul>
<li><p>Generación y producción del conocimiento.</p></li>
<li><p>Herramientas para uso y apropiación.</p></li>
<li><p>Cultura de compartir y difundir.</p></li>
<li><p>Analítica institucional para la toma de decisiones.</p></li>
</ul>
<p>La Analítica institucional para la toma de decisiones tiene especial
relevancia ya que se enfoca en el análisis de información e indicadores,
visualización de datos y decisiones basadas en evidencia; tomar
decisiones basadas en datos aporta a que se incentive en la entidad la
cultura del dato, permitiendo que esta se afiance y una vez implementada
perdure a través del tiempo.</p>
<h3 id="vertical">Vertical</h3>
<p>Lograr la coordinación y compromiso de todos los niveles de la entidad,
desde la cabeza principal y los directivos hasta los funcionarios que
desempeñan labores operativas específicas, pasando por equipos tácticos
y contratistas.</p>
<p>Los niveles definidos son [8]:</p>
<figure>
<img src="./images/gobd1/media/image5.png" style="width:6.25138in;height:2.27612in" />
</figure>
<p>Ilustración 5 Niveles Entidad</p>
<h2 id="política">Política</h2>
<p>El Fondo Nacional del Ahorro establece como activo los datos, la
información y el conocimiento para la toma de decisiones y el logro de
la misión estratégica de la entidad, incrementando la confianza de los
grupos de valor, los grupos de interés y contribuyendo a la innovación
pública y social.</p>
<h2 id="ejes">Ejes</h2>
<p>Se integran 5 ejes donde se concentran los esfuerzos: <em>Estrategia del
negocio, cumplimiento normativo, seguridad y privacidad del dato</em>, los
cuales se toman de las definiciones del DAMA ya que se acoplan
funcionalmente con las condiciones propias de la entidad; además, se
<em>adiciona el ciclo de vida del dato y gestión continua</em> lo que
posibilita tener una visión holística del dato y evaluar el uso,
aplicación y posibles ampliaciones del modelo a través de las instancias
previstas para ello.</p>
<ul>
<li><p><strong>Estrategia del negocio</strong>: Con el apoyo las áreas que conforman el
direccionamiento estratégico de la entidad se define un mecanismo
que permita la identificación la cadena de valor que permite tomar
buenas decisiones y resolver de forma óptima casos de uso del
negocio para cada uno de los interesados, con el fin de tener una
visión global que asegure las sinergias entre todas las fuentes de
información.</p></li>
<li><p><strong>Cumplimiento normativo</strong>: Con el apoyo del área jurídica definir
los mecanismos que permitan de manera proactiva hacer el seguimiento
y el acatamiento de reglas y normativa del dato en la entidad. por
medio de los responsables de las políticas que permitan garantizar
que los datos sean usados de acuerdo con las regulaciones y normas
vigentes.</p></li>
<li><p><strong>Seguridad y Privacidad del dato</strong>: Coordinar con el responsable de
la política que permite velar por la protección de los datos que ya
fueron o van a ser procesados, almacenados o trasmitidos, es decir,
durante todo su ciclo de vida.</p></li>
<li><p><strong>Ciclo de Vida del dato</strong>: Visión global del dato, es el ámbito
enfocado en asegurar el cubrimiento del enmascaramiento, reducción y
archivado de los datos en la institución, soportando el nivel de
autoservicio comprometido.</p></li>
<li><p><strong>Gestión Continua</strong>: Evaluar el uso, aplicación y posibles mejoras
a los procesos y procedimientos relacionados con el Gobierno del
Dato, así como la actualización del presente modelo en las
instancias definidas.</p></li>
</ul>
<h2 id="componentes">Componentes</h2>
<p>Se centra en tres elementos:</p>
<ul>
<li><p><strong><em>El patrocinio</em></strong>: Se materializa con el líder de datos que hace
parte del nivel estratégico.</p></li>
<li><p><strong><em>La propiedad:</em></strong> Es responsabilidad de cada área funcional con
los roles administrador y custodio.</p></li>
<li><p><strong><em>La administración:</em></strong> facilita la construcción de servicios de
gestión de datos al realizar las actividades específicas de los
siguientes enfoques [9] :</p></li>
</ul>
<!-- -->
<ul>
<li><p><u>Arquitectura del dato:</u> Es el componente del dominio de
información asociado con la coordinación de la estructura,
semántica, y calidad del dato desde el origen, así mismo,
participando en el diseño de los modelos y flujos de datos de las
aplicaciones.</p></li>
<li><p><u>Administración de datos Maestros:</u> Es la combinación de
procesos, gobernabilidad, políticas, estándares y herramientas que
se integran para ofrecer un único punto de referencia. Este se
enfoca en la necesidad de entender y derivar una visión interna de
la función pública y una eficiencia operacional a través de la
integración de vistas de productos, clientes, proveedores, activos,
ubicaciones, y otros elementos de la institución que existen dentro
de unidades diversas. Esta administración se asocia con los datos
mantenidos por los usuarios en áreas de la función pública y
expertos en la materia, no por los expertos de sistemas.</p></li>
<li><p><u>Calidad del dato:</u> Es el componente del dominio de
información asociado con procesos de ajuste y depuración de datos
masivos, y definición, medición y mejora continua de los indicadores
de calidad del dato.</p></li>
<li><p><u>Aprovisionamiento:</u> Es el componente del dominio de
información asociado con el movimiento de datos, tanto en línea como
en diferido, entre aplicativos operacionales y/o informacionales,
incrementando niveles de competencia y reutilizando componentes.</p></li>
<li><p><u>Gestión de la demanda:</u> Es el componente del dominio de
información asociado con la administración centralizada de la
demanda de datos de las áreas de funcionales del sector público.</p></li>
<li><p><u>Custodia del dato:</u> Es el componente del dominio de
información asociado con la identificación y definición clara del
custodio y consumidor del dato.</p></li>
</ul>
<h2 id="modelo-operativo">Modelo Operativo</h2>
<p>MINTIC propone que las entidades públicas adopten el gobierno del dato
desde la perspectiva del Modelo Federado, el cual es detallado en la
guía “G.INF.06 Guía Técnica de Información - Gobierno del dato”, según
este modelo operativo la responsabilidad de los datos se delega en cada
área funcional, se coordina con las áreas de TI y se da gran relevancia
a que exista en cada una de estas áreas funcionales los roles de gestor
y administrador del dato; al momento de realizar la implementación las
actividades se enfocan en: Administración del dato maestro, Arquitectura
del dato, Custodia del dato, Calidad del dato, Gestión de la demanda y
Aprovisionamiento. En paralelo el flujo bidireccional de la
administración de los datos y el servicio de gestión de datos
interactuara con los diferentes niveles y responsables establecidos.</p>
<p>A partir de la siguiente Ilustración, se muestra el Modelo Federado /
Orquestado para Gobierno del Dato, sus principales características son:</p>
<ul>
<li><p>Delega en cada área funcional involucrada en el sector público, la
responsabilidad de sus dominios de datos maestros.</p></li>
<li><p>Coordina con las diferentes áreas de TI existentes, los mecanismos
implicados en el buen Gobierno de Datos.</p></li>
<li><p>Cada área funcional de la institución debe existir gestores y
administradores del dato, responsables del buen gobierno de los
datos maestros.</p></li>
</ul>
<figure>
<img src="./images/gobd1/media/image6.png" style="width:4.83333in;height:3.61111in" />
</figure>
<h2 id="comité-gobierno-de-datos">Comité Gobierno de datos</h2>
<p>La óptima gestión de datos requiere de un marco que acoja un gobierno de
datos, entendido como el ejercicio de diseñar, controlar y monitorizar
todo lo relativo a los datos desde un enfoque holístico, en el que
participen los implicados, desde el gobierno y el departamento de TI
hasta un consejo de gestión de datos que representa las partes
interesadas [10]</p>
<p>Se hace entonces necesario crear una máxima instancia de coordinación
institucional con el propósito Impulsar la política de uso y
aprovechamiento de datos en la entidad, y la orientación de acciones
tendientes a fortalecer la gobernanza, circulación y reutilización de
datos. [8]</p>
<figure>
<img src="./images/gobd1/media/image7.png" style="width:6.60095in;height:3.27986in" />
</figure>
<p><span id="_Toc110619199" class="anchor"></span>Ilustración 7 Comité Gobierno de Datos</p>
<p><strong>Mesa Administrativa</strong></p>
<p>Espacio de toma de decisiones donde participan los encargados de
identificar los datos de acuerdo con los objetivos estratégicos y
funciones de la dependencia, así como velar por su actualización. </p>
<p><u>Asistentes</u>:    Enlaces Funcionales designados por las
dependencias.</p>
<p><u>Frecuencia</u>: Trimestral</p>
<p><strong>Mesa Operativa</strong></p>
<p>Espacio de coordinar la ejecución y plantear alternativas donde
participan los encargados de orquestar las necesidades y las acciones
técnicas.</p>
<p><u>Asistentes</u>:    Enlaces Técnicos designados por las
dependencias.</p>
<p><u>Frecuencia</u>: 2 Veces previa a la Mesa administrativa. (1
sesión Por sectores, 1 sesión General)</p>
<p><strong>Grupo Trabajo</strong></p>
<p>Según se requiera se realizarán para tratar un tema u obtener un
entregable especifico y dichos resultados se trasladan a la mesa
operativa.</p>
<h2 id="roles-y-funciones">Roles y Funciones</h2>
<p>Por parte del MINTIC se definen como necesarios para la implementación y
operación del modelo de Gobierno en el Fondo Nacional del Ahorro los
siguientes roles [9]:</p>
<ul>
<li><p><strong>Gestor del dato:</strong> Es el encargado del direccionamiento
estratégico para gobernar el valor y uso del dato, y de definir las
reglas de consolidación y coordinación con los administradores de
unos datos en sus respectivos dominios. A veces, se encarga de la
corrección manual de la información en caso de que las reglas
generales no sean válidas para algún caso concreto.</p></li>
<li><p><strong>Custodio del dato:</strong> Es el responsable por la existencia de unos
datos en la función del sector público, por lo que cualquier acción
correctiva o nuevo requisito que precise su información, debe ser
consensuado con él. Igualmente es el responsable de que el dato esté
disponible y con atributos de calidad. Adicionalmente, este actúa
como patrocinador de calidad y control sobre estos datos, y es
considerado experto en conocimiento sobre el dato que es custodio.</p></li>
<li><p><strong>Administrador del dato:</strong> Es el encargado de orquestar las
necesidades y las acciones técnicas, así como mediar en los posibles
conflictos que puedan surgir entre roles consumidores y productores.
Para esto, crea estándares y buenas prácticas, habilita metadatos
técnicos, operacionales y funcionales, audita la calidad de los
datos y las medidas de gobernanza, y define políticas de respaldo de
la información (backups), seguridad, flujos de datos, etc.</p></li>
</ul>
<p>Una vez analizadas las condiciones de estructura organizacional, cultura
y necesidades propias del Fondo Nacional del Ahorro, se opta por
establecer los siguientes roles necesarios para la correcta
implementación del modelo de Gobierno de Datos definido:</p>
<table style="width:99%;">
<colgroup>
<col style="width: 19%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="header">
<th>Líder de
datos</th>
<th><p>Patrocinador ejecutivo del gobierno de datos que se
asegure de que las iniciativas y proyectos con datos
tengan suficientes recursos y se entienda la visión y
objetivos estratégicos de la entidad.</p>
<ul>
<li><p>Definir la estrategia de datos.</p></li>
<li><p>Vigilar y aplicar la ética de los datos.</p></li>
<li><p>Direccionar la creación de estándares, políticas y
procesos que determinen el uso, desarrollo y
gestión de los datos a nivel de la entidad.</p></li>
</ul></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Comité de
Gobierno de
Datos</td>
<td>Trabaja como Gestor del dato al supervisar y hacer
cumplir las políticas, procedimientos y estándares
sobre gobierno de datos (Designados dependencias +
Innovación Digital)</td>
</tr>
<tr class="even">
<td>Ad
ministrador</td>
<td><p>Son los encargados de orquestar las necesidades y las
acciones técnicas, así como mediar en los posibles
conflictos que puedan surgir entre roles consumidores
y productores. Para esto, crea estándares y buenas
prácticas, habilita metadatos técnicos, operacionales
y funcionales, audita la calidad de los datos y las
medidas de gobernanza y define políticas de respaldo
de la información (backups), seguridad, flujos de
datos, etc. Son los servidores adscritos a la
Secretaría de Innovación Digital encargados de
proteger los datos entregados por los custodios para
su disposición <strong><em><u>en cada uno de los repositorios
oficiales</u></em></strong> disponibles (lago de datos,
NAS, entre otros).</p>
<ul>
<li><p>Apoyar la revisión de la arquitectura.</p></li>
<li><p>Apoyar en el entrenamiento y trasmisión
del conocimiento.</p></li>
<li><p>Apoyar células temáticas requeridas.</p></li>
<li><p>Monitorear el cumplimiento de las políticas.</p></li>
<li><p>Monitorear la calidad de los datos.</p></li>
<li><p>Monitorear las iniciativas</p></li>
<li><p>Generar buenas Prácticas.</p></li>
<li><p>Identificar datos Maestros y Metadatos.</p></li>
<li><p>Establecer flujos de datos.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td>Custodio</td>
<td><p>Encargados de generar los datos, también pueden
denominarse dueños de los datos, son el actor más
importante dado que tiene la responsabilidad de
mantener actualizados los datos y proponer la
identificación de estos, de acuerdo con la misión,
visión y funciones que prestan (Dependencias del nivel
central y conglomerado).</p>
<ul>
<li><p>Crear la visión del gobierno de datos.</p></li>
<li><p>Definir los principios</p></li>
<li><p>Asignar los roles y responsabilidades.</p></li>
<li><p>Actualizar y hacer seguimiento a la política.</p></li>
<li><p>Establecer reglas para el gobierno externo de los
datos</p></li>
<li><p>Buscar oportunidades de datos.</p></li>
<li><p>Fomentar la Comunicación Institucional</p></li>
</ul></td>
</tr>
</tbody>
</table>
<p><span id="_Toc82980949" class="anchor"></span></p>
<p>Ilustración 8: Roles de gobierno de datos</p>
<h1 id="referencias">Referencias</h1>
<table style="width:99%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">[1]</th>
<th style="text-align: left;">DNP, «https://www.dnp.gov.co/,» [En línea]. Available:
https://www.dnp.gov.co/Paginas/Colombia-primer-pa%C3%ADs-en-Latinoam%C3%A9rica-con-una-pol%C3%ADtica-p%C3%BAblica-para-la-explotaci%C3%B3n-de-datos-Big-Data.aspx.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">[2]</td>
<td style="text-align: left;">DNP, «MODELO DE EXPLOTACIÓN DE DATOS PARA ENTIDADES PÚBLICAS,» 2020.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[3]</td>
<td style="text-align: left;">Logicalis, «Logicalis,» 2 febrero 2014. [En línea]. Available:
https://blog.es.logicalis.com/analytics/bid/370961/c-mo-definir-las-pol-ticas-del-gobierno-de-los-datos-data-governance.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[4]</td>
<td style="text-align: left;">A. Data Management, DMBOK, New Jersey: Technics Publications, LLC, 2010.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[5]</td>
<td style="text-align: left;">Data Goverment Institute, «How to use de DGI Data Governance Freamework to Configure Your Program,» [En línea]. Available: www.DataGovernance.com. [Último
acceso: 07 2021].</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[6]</td>
<td style="text-align: left;">S. Sunil, The IBM Data Governance Unified Process: Driving Business Value with IBM Software and Best Practices, MC Press, 2010.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[7]</td>
<td style="text-align: left;">N. Askham, «Squaring the circle : using a Data Governance Framework to support Data Quality,» <em>Experian Whitepaper,</em> p. 9, 2014.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[8]</td>
<td style="text-align: left;">DAPRE, «DECRETO 1389 DEL 28 DE JULIO DE 2022,» [En línea]. Available:
https://dapre.presidencia.gov.co/normativa/normativa/DECRETO%201389%20DEL%2028%20DE%20JULIO%20DE%202022.pdf.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[9]</td>
<td style="text-align: left;">MINTIC, «mintic.gov.co,» Octubre 2019. [En línea]. Available: https://mintic.gov.co/arquitecturati/630/articles-9258_recurso_pdf.pdf. [Último acceso: 05 10
2021].</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[10]</td>
<td style="text-align: left;">MINTIC, «Documento técnico y hoja de ruta PNID,» [En línea]. Available: https://www.mintic.gov.co/portal/715/articles-179710_recurso_2.pdf.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Gobierno SOA: <strong>Mejora de los indicadores de efectividad (madurez) SOA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Inversión TI, Eficacia, KPI, Proceso SOA</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Fase 2 PR6 Gobierno SOA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="indicadores-de-efectividad-del-gobierno-soa">Indicadores de Efectividad del Gobierno SOA</h2>
<p>Más allá de los índices propuestos por el análisis de madurez SOA desarrollado en la Fase 1 de este diagnóstico, <em>para el FNA es clave mantener activo el vínculo de sus activos tanto de infraestructura como los activos SOA (y de todos, aunque se escapen del alcance de este ejercicio) con el contexto de negocio de las vicepresidencias de Operaciones y de Crédito</em>. Esto es, el principal indicador del gobierno SOA es la existencia y actualidad de los vínculos entre los contextos de negocio y la arquitectura de referencia SOA FNA, y su tecnología.</p>
<p>Este solo indicador del gobierno SOA, el del vínculo de los contextos negocio-tecnología SOA, que es útil también para otras disciplinas de gestión TI, <em>identifica y justifica los costos de un cambio en relación al Valor de negocio que pueda traer</em>. Sirve de base para los procesos de obsolutamente todas las decisiones de cambio, mejora, inversión, recorte, y otras propias de la gestión de la tecnología SOA.
Sirve además para medir la confiabilidad de los análisis que sobre los modelos se realicen. <em>Es por estas razones que para el Fondo este es el principal indicador de gobierno SOA a desarrollar</em>.</p>
<p>De todos, el indicador de Vínculo Contexto Negocio-SOA es el más importante para el FNA. Para mantener el puntaje de este indicador alto debe recurrir a la actualización y mantenimiento del repositorio de arquitectura. En la medida en que este repositorio capture la mayor cantidad de información de los contextos referidos, el indicador aumentará, a la vez que el repositorio será un activo clave para todas las opeaciones de gestión de TI del FNA.</p>
<figure>
<img src="images/vinculocontexto.png" />
</figure>
<p><a href="">Imagen 1.</a> Indicador principal del gobierno SOA: KPI de Vínculo Contexto Negocio-SOA. Identifica y justifica los cambios SOA en relación al Valor de negocio.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<h2 id="indicadores-complementarios-del-gobierno-soa">Indicadores Complementarios del Gobierno SOA</h2>
<p>Los siguientes indicadores han sido escogidos para atacar los problemas en la gestión de SOA encontrados en la Fase 1 del presente diagnóstico (ver <a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">04b.Resumen Fase 1</a>). sirven de base de pirámide para el indicador principal.</p>
<ol type="1">
<li>Índice de alineación de la arquitectura de referencia SOA con las capacidades de negocio</li>
<li>Índice de conformidad de los servicios SOA a los estándares de diseño orientados a servicio</li>
<li>Índice de reutilización y composición de los servicios SOA del portafolio FNA</li>
</ol>
<p><br></p>
<p>Cada uno de estos indicadores debe ser soportados con fuentes de información existentes o por desarrollar, que aparecen en la imagen como <em>Objeto de información</em>.</p>
<figure>
<img src="images/indices.png" />
</figure>
<p><a href="">Imagen 1.</a> Indicador principal del gobierno SOA: KPI de Vínculo Contexto Negocio-SOA. Identifica y justifica los cambios SOA en relación al Valor de negocio.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<p>Algunas fuentes u objetos de información sugeridas y ya existentes en el FNA son, por ejemplo, el número y tipo de requerimientos registrados en las herramienta de gestión, como Clear Case (IBM); los resultados de las evaluaciones de calidad de las implementaciones de los proveedores del Fondo; o el número de casos correctivos en un período contenidos en el Service Manager, entre otros.</p>
<p><br></p>
<h2 id="indicadores-de-eficiencia-soa">Indicadores de Eficiencia SOA</h2>
<p>Además de los indicadores del proceso de gobierno SOA enunciados arriba, el FNA debe ejercer el gobierno SOA sobre los siguientes indicadores de eficiencia de la arquitectura de referencia.</p>
<h3 id="del-análisis-de-madurez-soa-del-fna-fase-1">Del Análisis de Madurez SOA del FNA (Fase 1)</h3>
<p>La dimensión que tuvo puntajes meritorios fue la de Negocio que alcanzó el segundo percentil de eficacia: 37 / 100. Este índice sintetiza el hecho de que operativamente SOA responde a las exigencias de negocio del FNA, pero con esfuerzos altos que seguramente afectan el retorno de inversión SOA.</p>
<p>Según los resultados internos del diagnóstico, los problemas del alto esfuerzo en la eficacia de la dimensión de negocio es causado por las dificultades siguientes:
1. El bajo grado de independencia de proveedor: (ver imagen abajo) <em>38 puntos / 100 puntos</em>
1. Muy baja flexbilidad y tiempos de entrega (time-to-market): <em>20 / 100 puntos</em>.</p>
<figure>
<img src="images/analisisSOA-1.png" />
</figure>
<p><a href="">Imagen.</a> Resultados Según los resultados internos del diagnóstico. Dimensión de Negocio.</p>
<p><em>Fuente: herramienta de diagnóstico de madurez SOA. Elaboración propia</em>.</p>
<p><br></p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Gobierno SOA: <strong>Consideraciones para la puesta en marcha del gobierno SOA en el FNA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Inversión TI, Eficacia, KPI, Proceso SOA</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">Fase 2 PR6 Gobierno SOA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="consideraciones-para-implementación-del-gobierno-soa-en-fna">Consideraciones para Implementación del Gobierno SOA en FNA</h2>
<h3 id="marco-de-trabajo-para-implementar-gobierno-soa-en-fna">Marco de Trabajo para Implementar Gobierno SOA en FNA</h3>
<p>Un Marco de trabajo adaptado para la organización que responde y gestiona los cambios evolutivos de la arquitectura de referencia SOA instalada en el Fondo. Esta versión del marco de gobierno, que necesariamente es una versión inicial para el FNA dado el resultado del análisis de madurez de la Fase 1, procura únicamente la gestión de cambios de la arquitectura. Versiones posteriores de este modelo puede y deberá abordar problemáticas señaladas por nuevos análisis.</p>
<figure>
<img src="images/modelo-gob.png" />
</figure>
<p><a href="">Imagen 1.</a> Actores del FNA necesarios para el Gobierno SOA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<h3 id="equpo-de-trabajo-para-el-gobierno-soa-del-fna">Equpo de Trabajo para el Gobierno SOA del FNA</h3>
<p>El equipo de trabajo requerido conforme el modelo de gobierno SOA presentado aquí se compone del capital humano en los roles de gestión de la tecnología y arquitectura en los ámbitos de diseño de servicios y componentes, infraestructura tecnológica y redes, aplicaciones de solución y herramientas de software y del especialista de las estructuras de negocio e información. Estos recursos deben ser preferiblemente internos a la organización debido a la gestión de conocimiento del <em>activo más importante del gobierno SOA, la arquitectura de referencia y los vínculos de esta con los contextos de negocio y TI</em>.</p>
<figure>
<img src="images/equipo-gob.png" />
</figure>
<p><a href="">Imagen 2.</a> Roles y Grupos de trabajo del gobierno SOA del FNA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<h3 id="proceso-de-gobierno-soa-para-el-fna">Proceso de Gobierno SOA para el FNA</h3>
<p>Por último, el proceso de gobierno SOA es la conjugación de las dos condiciones aquí presentadas, el marco de trabajo (acciones y herramientas) y el equipo de trabajo, que son los recursos de capital humano y sus intereacciones. Este proceso adaptado al FNA busca alcanzar los objetivos SOA determinados por este diagnóstico. (ver imagen abajo)</p>
<figure>
<img src="images/proceso-gob.png" />
</figure>
<p><a href="">Imagen 3.</a> Actividades y relaciones del proceso principal de gobierno SOA para el FNA. Relación con capacidades y objetivos SOA necesarios para el FNA.</p>
<p><em>Fuente: elaboración propia.</em></p>
<p><br></p>
<p>El proceso de gobierno SOA está en línea y apoya a las capacidades SOA que el FNA debe implementar. De esa manera, las capacidades SOA relacionadas con este proceso buscan lograr los objetivos SOA establecidos por esta consultoría y que el FNA debe perseguir.</p>
<h2 id="anexos">Anexos</h2>
<h2 id="procedimiento-del-área-ti-del-fna">1. Procedimiento del Área TI del FNA</h2>
<p>Anexo en línea.
<a href="https://stefaninilatam.sharepoint.com/:f:/r/sites/PROYECTOARQUITECTURAE-SERVICEFNA/Documentos%20compartidos/General/Repositorio%20SOA/Procesos/181-2020.%20E-SERV.%20Fase%202.%20docx/Procedimientos%20TI?csf=1&amp;web=1&amp;e=JtH2vm">Procedimientos TI del Fondo</a>.</p>
<p>Fuente: <em>Fondo Nacional del Ahorro</em>.</p>
<p><br></p>
<h2 id="niveles-de-inversión-ti-del-fna">2. Niveles de Inversión TI del FNA</h2>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="header">
<th>Rubro</th>
<th>Nivel / Procentaje</th>
<th>Destino</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Equipos / Infraestructura técnica/arrendamientos</td>
<td>30%</td>
<td>Hardware IBM, hosting/nube sap, equipos ofimaticos, impresoras, facilites, red wan, red lan, cintas medios magneticos, grabacion de llamadas, kioskos, planta electricas, bolsa monitores, canales y buckup, inversiones (balanceadores, swithes)</td>
</tr>
<tr class="even">
<td>Servicios externos</td>
<td>26%</td>
<td>Fábricas, boton de pagos, biometria, mesa de servicios, certificados digitales, admon bda, admon soa, admon itom, 2FA, Cape, Soc, platafomas a las ventas, custodia de medios, validacion de identidad, factura electronica</td>
</tr>
<tr class="odd">
<td>Productos</td>
<td>23%</td>
<td>CRM, Adminfo, Cobis, SAP -ERP, Workmanger, RPA, Credito constuctor</td>
</tr>
<tr class="even">
<td>Mantenimiento Licencias/suscripcion</td>
<td>19%</td>
<td>Software IBM, Oracle, Cisco, itom, elearning, kactus, isolucion, microsoft, motores bases de datos, megahopex, adobe cloud, Vmware, red hat, sistema de turnos, bizagi, DLP, logica, ciberseguridad, herramientas ciberdefensa, qualitty, pam, antimalware, goanywere, Microfocus fortify - idm, dam</td>
</tr>
<tr class="odd">
<td>Soporte/admon de softw.</td>
<td>2%</td>
<td>DLP, herramientas ciberdefensa, qualitty, pam, antimalware, goanywere, Microofus fortify - idms, dam, elearning, kactus, isolucion, servicios cartelera digital</td>
</tr>
</tbody>
</table>
<p>Fuente: <em>Fondo Nacional del Ahorro</em>.</p>
<hr />
<h1 id="fase-2-soa-objetivo-fna-2">Fase 2: SOA Objetivo FNA</h1>
<h1 id="contenido-de-los-productos-contractuales-181-2020-2">Contenido de los Productos Contractuales, 181-2020</h1>
<h1 id="producto-7-pr7.-vigilancia-tecnológica-soa">Producto 7: PR7. Vigilancia Tecnológica SOA</h1>
<p>Describir y justificar la selección de tecnologías y las técnicas de diseño, implementación y gestión de servicios SOA aplicables al Fondo Nacional del Ahorro (FNA).</p>
<p><strong>Nota</strong>: los análisis de este producto están dirigidos a cumplir los objetivos del proyecto SOA: dependencia de proveedor (OBJ1), fortaleza SOA de las aplicaciones (OBJ2), y tiempo de mercado (OBJ3).</p>
<p><br></p>
<h2 id="justificación-2">Justificación</h2>
<p>Identificar los avances en el desarrollo SOA que impulsen a las iniciativas y propuestas de solución SOA para el FNA.</p>
<h2 id="contenidos-2">Contenidos</h2>
<ol type="1">
<li>Lista tecnologías SOA afines al Fondo</li>
<li>Lista de beneficios al FNA por las tecnologías seleccionadas</li>
<li>Implicaciones para la adquisición y adopción tecnológica</li>
</ol>
<p><br></p>
<h2 id="criterios-de-aceptación-2">Criterios de Aceptación</h2>
<ul>
<li>Evaluación e Identificación de la tecnología SOA en alineación con los objetivos del proyecto</li>
<li>Presentación de una arquitectura SOA candidata versión 1.1</li>
</ul>
<hr />
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Vigilancia Avances de Industria: <strong>Estrategia de modelado e identificación de servicios</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Tecnologías, Vigilancia, Avances</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td>9b3a97c del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">N003a Vista Segmento SOA FNA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="arquitecturas-orientadas-a-servicios-soa">Arquitecturas Orientadas a Servicios (SOA)</h2>
<p>SOA como estilo de arquitectura, representó un cambio fundamental en los
procesos de desarrollo de soluciones informáticas, así como de procesos
de negocio, en los últimos años. Como estilo de arquitectura, el uso de
SOA pretendía favorecer la reutilización de código con la promesa de
construir piezas de software que pudieran ser localizadas y consumidas
por demanda.</p>
<p>En la actualidad, vemos que varias de las premisas se cumplieron, pero
otras no han podido realmente implementarse. En primer lugar, la
construcción de servicios ha presentado un reto en cuanto al diseño y
granularidad de los servicios, los mecanismos de despliegue y
comunicación de servicios y su relación con las arquitecturas
monolíticas y la evolución y mantenimiento de los servicios. Otro
aspecto que hace complejo el uso de los servicios, es el costeo de los
servicios y la demostración del retorno de inversión de los mismos.</p>
<h3 id="diseño-y-granularidad-de-los-servicios">Diseño y granularidad de los servicios</h3>
<p>En buena medida la justificación de reutilización de los servicios ha
ido implicando que se implementen modificaciones y extensiones al
software para cubrir diferentes funcionalidades de negocio dentro de la
organización. Lo anterior implica que para poder reutilizar un servicio,
usualmente se adicionan a su implementación funcionalidades nuevas
específicas para una unidad de negocio. Lo anterior genera un aumento en
el tamaño del código y la complejidad de los servicios. Finalmente, esto
redunda en un decremento de la disponibilidad de los servicios, aumento
de las fallas en producción y aumento en los costos de mantenimiento y
modificación de cada servicio.</p>
<h3 id="mecanismos-de-comunicación">Mecanismos de Comunicación</h3>
<p>SOA como toda tecnología ha venido evolucionando. En temas de
comunicación, los inicios de SOA impusieron SOPA y WS-* como mecanismos
de intercambio de información y flujo de lógica de negocio. Sin embargo,
la complejidad de SOAP sigue siendo un limitante en la utilización de
SOA. La utilización reciente de mecanismos más ligeros como REST y JSON
han facilitado el uso de los servicios, principalmente intermediados por
APIs.</p>
<p>El esquema de trabajo actual ha permitido el uso de servicios aunque la
realidad es que las aplicaciones actuales tienen una mezcla de servicios
legados utilizando SOAP con nuevos servicios utilizando REST. Esto lleva
a introducir nuevos elementos en la arquitectura, como conectores y
adaptadores, complicando un poco más el ecosistema de servicios de una
solución.</p>
<h3 id="arquitecturas-monolíticas-y-servicios">Arquitecturas Monolíticas y Servicios</h3>
<p>Uno de los principales retos desde el punto de vista de arquitectura y
el uso de los servicios es poder mantener una consistencia de la oferta
de servicios con las aplicaciones legadas de la organización. Muchas de
las implementaciones de servicios, proponen un nivel intermedio que
oculta o encapsula la funcionalidad de aplicaciones legadas. En este
sentido los servicios son ofrecidos como puntos de contacto con los
consumidores de la lógica de negocio. Estos servicios realizan labores
de transformación y adaptación para poder llamar lógica de negocio de
sistema legados.</p>
<p>Esta estrategia ha funcionado en buena medida, pues aplicaciones que no
habían sido pensadas para interoperar en esquemas heterogéneos de
soluciones, ahora pueden ser incluidas en este tipo de orquestaciones
mediante los servicios que las representan. Sin embargo, aun cuando se
tiene un nuevo nivel de servicios, las aplicaciones siguen siendo
monolíticas y por lo tanto, su migración, reutilización, modificación y
adaptación, conlleva grandes tiempos y esfuerzos. SOA en este sentido se
ha visto como una opción válida para la exposición de capacidades
expuestas por aplicativos legados, sin embargo, también implica tiempos
de entrada en producción altos y costos considerables.</p>
<p>El uso de SOA no facilita la incorporación de prácticas como la
integración continua y el despliegue continuo, requeridas actualmente en
los procesos de desarrollo modernos y en organizaciones más ágiles.</p>
<h3 id="localización-y-orquestación">Localización y Orquestación</h3>
<p>Otro aspecto a considerar es el uso de tecnologías para la localización
y orquestación de servicios. Hasta hace unos años, el bus de servicios
(ESB) era una parte fundamental de los ecosistemas de tecnología de las
organizaciones, fundamentalmente en esquemas de despliegue on-premises.
Los ESB se convirtieron en pieza fundamental para la orquestación de
servicios y para la construcción de soluciones basadas en llamados
sincrónicos entre servicios. Este esquema funciona, cuando en general
todas las aplicaciones involucradas se encuentran desplegadas en un
mismo ambiente (por ejemplo: on-premises). Sin embargo, con la llegada
de la nube y el despliegue de soluciones en este ambiente, los ESB no
encajan perfectamente, ni tampoco ofrecen soluciones claras para
arquitecturas no monolíticas y heterogéneas.</p>
<h3 id="reflexiones">Reflexiones</h3>
<p>Si bien SOA constituye una alternativa viable y vigente para la
construcción de soluciones basadas en servicios, su utilización y
evolución a futuro deja muchas inquietudes e interrogantes. Las
arquitecturas actuales, se han convertido en algo más híbrido, con el
uso de soluciones on-premises mediades por buses de servicios, y
soluciones desplegadas en la nube, orientadas a eventos y coreografía de
servicios en lugar de los esquemas tradicionales de orquestación.</p>
<p>Si bien, los activos desarrollados en esquemas tradicionales de SOA y
ESBs siguen siendo utilizados y la inversión realizada en estas
soluciones debe seguir siendo recuperada, es importante gradualmente ir
considerando una migración a soluciones basadas en eventos, colas de
mensajes y esquemas de comunicación más orientados a la nube, somo los
service-mesh.</p>
<h2 id="web-oriented-architectures-woa">Web Oriented Architectures (WOA)</h2>
<p>El esquema SOA se ha venido combinando con esquemas más orientados al
uso de las tecnologías Web. A este cambio se le denomina el Web Oriented
Architectures (WOA), o arquitecturas de solución orientadas al uso de
tecnologías como Microservicios, APIs(API Economy), Arquitecturas
Orientadas a Eventos, y mecanismos alternativos para la orquestación y
comunicación sincrónica de microservicios (Service-Mesh).</p>
<h3 id="api-api-economy">API / API Economy</h3>
<p>En la actualidad las APIs han pasado de ser un mecanismo de integración,
a un elemento crítico tanto a nivel interno dentro de las
organizaciones, como mecanismo de interoperabilidad entre socios de
negocio y clientes finales.</p>
<h4 id="portafolios-de-apis">Portafolios de APIs</h4>
<p>Uno de los riesgos, sin embargo, que presenta esta estrategia de
integración, es la proliferación de APIs sin control, un bajo esquema de
gobierno que no controle la creación de dichas APIs, así como su
evolución y mantenimiento.</p>
<p>Un mecanismo para solucionar este riesgo, es diseñar un portafolio de
APIs, donde se mantenga una estructura clara y controlada de los
diferentes tipos de APIs con los que cuenta la organización. Este
portafolio debe ser diseñado con cuidado, buscando satisfacer atributos
de calidad, niveles de servicios, monitoreo en ejecución, documentación
y entrenamiento, así como control de costos y propiedad.</p>
<p>Actualmente las organizaciones hablan de un término denominado API
Economy, que tiene dos visiones. De una parte el negocio va hora en las
APIs de la organización, una nueva fuente de ingresos, como consecuencia
de la implementación de procesos con clientes y socios de negocio. De
otra parte, las áreas de tecnología de las organizaciones, ven en el uso
de las APIs, un mecanimo de comunicación y tercerización de sus tarea de
desarrollo de software con fábricas de software y desarrolladores.</p>
<h4 id="proceso-de-diseño-de-apis">Proceso de diseño de APIs</h4>
<p>Usualmente la organización tiene muchas APIs que van surgiendo con el
paso del tiempo. Un portafolio de APIs es más que una colección
desordenada de APIs. El portafolio debe ser diseñado con cuidado, de
forma que todas las APIs del portafolio sean consistentes unas con
otras, reutilizables, descubribles y personalizables.</p>
<p>El Portafolio debe cumplir con requisitos funcionales y no funcionales
como : consistencia, reuso, personalización, descubrimiento y longevidad</p>
<p>Consistencia: Un cliente o una solución seguramente usarán varias APIs
del portafolio. Es deseable que la salida de una API pueda ser usada
como entrada en otra API. Si las entradas esperadas por una API son muy
difíciles de lograr a partir de las mismas salidas de otra API del
portafolio, se tendrá falta de consistencia. Una estrategia para
favorecer la consistencia es abstraer aspectos comunes y llevarlos a
otras APIs.</p>
<p>La URI de las APIs debe seguir una estructura común e intuitiva: Nombres
de campos y formatos deben ser consistentes a lo largo del portafolio.
Las validaciones a las entradas deben hacerse de forma similar en todo
el portafolio. Los mecanismos de seguridad deben ser los mismos en todo
el portafolio.</p>
<p>Reuso: De ser posible las APIs no debe ser construidas para un cliente
específico. Se espera que su diseño e implementación sirvan a múltiples
consumidores, al menos parcialmente.</p>
<ul>
<li><p>Reuso de algunas características de las APIs</p></li>
<li><p>Reuso de APIs completas</p></li>
<li><p>Reuso de APIs propias</p></li>
<li><p>Reuso de APIs de terceros</p></li>
</ul>
<p>Personalizable: Si bien las APIs no deberían ser diseñadas para un
cliente específicamente, si deben poder ser configurables y
personalizables para la necesidad particular un cliente o grupo de
clientes. Aspectos a personalizar: Formateo de datos, entrega de datos,
agrupamiento de datos</p>
<p>Descubrible: Debe ser fácil para un consumidor descubrir las APIs
ofrecidas en el portafolio. El portafolio debe ofrecer mecanismos de
consulta y descubrimiento de las APIs, de forma que para los
consumidores se fácil encontrar el API que buscan.</p>
<p>Longevidad: Se debe buscar que las APIs sean funcionales por la mayor
cantidad de tiempo posible. Esto usualmente ocurre cuando una API
refleja la propuesta de valor del cliente, dado que estas se mantienen
en el tiempo. Desde el punto de vista técnico, se espera que las APIs
evolucionen constantemente, pero las firmas de las operaciones deben
permanecer estables tanto como sea posible.</p>
<p>Gobernable: Se debe buscar un equilibrio entre un proceso de desarrollo
de APIs ágil que permita probar fácilmente nuevas iniciativas de
negocio. Reglas y políticas firmes para evitar el desorden en el
portafolio de APIs.</p>
<p>El proceso de desarrollo de APIs dentro de las organizaciones debe ser
institucionalizado y formalizado. Se debe buscar formalizar el diseño,
desarrollo y puesta en producción de las APIs de la organización. Como
mínimo los proyectos de diseño y desarrollo de APIs deberían contar con
actividades como análisis, desarrollo, operación y retiro.</p>
<h5 id="análisis">Análisis</h5>
<p>La fase de análisis debe buscar responder preguntas como:</p>
<ul>
<li><p>¿La organización requiere una API?</p></li>
<li><p>¿Cuáles funciones cumpliría?</p></li>
<li><p>¿Cuál es la propuesta de valor de esta API?</p></li>
<li><p>¿La propuesta será algo fundamental para el negocio?</p></li>
<li><p>¿Qué requiere el negocio para operar esta API?</p></li>
<li><p>¿Cuáles métricas se deben cumplir?</p></li>
</ul>
<p>El objetivo fundamental de la fase de análisis deberá ser la alineación
con las necesidades de negocio. Entendiendo que unidades de negocio
serán usuarias de la API y cuáles serán propietarias y financiadores de
las APIs. En este sentido es fundamental entender qué tipo de API se
desea desarrollar:</p>
<p>APIs Privadas: Usualmente buscan modernizar tecnología y procesos dentro
de la organización, optimizar la cadena de valor e integrar sistemas de
información legados al interior de la compañía.</p>
<p>APIs tipo consorcio: Buscan usualmente mejorar procesos operativos con
socios de negocio y proveedores de servicios. Buscan mejorar la gestión
administrativa entre socios y mejorar el relacionamiento y comunicación
externa con empresas del ecosistema de la organización. Responder a
regulaciones de industria y exponer información parcialmente pública.</p>
<p>APIs Públicas: Buscan automatizar procesos con clientes y potenciales
clientes, mejorar la experiencia de usuarios y público en general,
reducir tiempos de ingreso al mercado y proveer nuevas opciones de
integración e interoperabilidad.</p>
<h5 id="desarrollo">Desarrollo</h5>
<p>Se deben definir estándares de desarrollo, tecnologías aprobadas por la
organización para la implementación de APIs, tipos de APIs a
desarrollar, pero sobre todo, tener en cuenta los atributos de calidad
que debe exponer el API a desarrollar. Por ejemplo, a nivel de desempeño
determinar las cargas de trabajo, niveles de escalabilidad, tiempos de
respuesta y volúmenes de datos por unidad de tiempo que podrán ser
respondidos ante una consulta. Determinar la utilización de REST como
esquema de comunicación o la adopción de nuevas tecnologías como
GraphQL.</p>
<p>En este punto la organización debe tomar decisiones relacionadas con:</p>
<ul>
<li><p>Librerías de bloques construcción reutilizables</p></li>
<li><p>Lenguajes de implementación de APIs</p></li>
<li><p>IDEs y depuradores</p></li>
<li><p>Lenguajes de diseño para APIs</p></li>
<li><p>Herramientas para diseño de interfaces para APIs</p></li>
<li><p>Herramientas para la generación de código y documentación</p></li>
</ul>
<h5 id="operación-plataforma-de-ejecución">Operación / Plataforma de ejecución</h5>
<p>La plataforma de ejecución se encarga de la puesta en producción,
despliegue y consumo de las APIs en operación. Esta plataforma se
encarga de responder a consultas hechas a las APIs, favoreciendo
atributos de calidad como la baja latencia y la escalabilidad.</p>
<p>La plataforma de ejecución se encarga de la ejecución de las APIs. Se
encarga de la recepción de peticiones desde los consumidores y de la
entrega de las respuestas. Esta plataforma también responsable del
cumplimiento de los atributos de calidad, como el desempeño, la
disponibilidad y la seguridad. Algunas tácticas de arquitectura que
ejecuta la plataforma de ejecución son: balanceo de carga, cache y pool
de conexiones. La plataforma ofrece también servicios de monitoreo, log,
análisis de cumplimientos de niveles de servicio.</p>
<p>La plataforma de ejecución es responsable igualmente por proveer
capacidades para facilitar el despliegue de nuevas APIs y el
mantenimiento de APIs existentes. Igualmente, esta plataforma se encarga
del manejo de credenciales y configuraciones de múltiples ambientes de
ejecución.</p>
<p>Dentro de las decisiones a tomar con la plataforma de ejecución, se
encuentra la configuración de múltiples ambientes de ejecución:</p>
<ul>
<li><p>Desarrollo</p></li>
<li><p>Sandbox o simulación</p></li>
<li><p>Testing</p></li>
<li><p>Preproducción</p></li>
<li><p>Producción</p></li>
</ul>
<h5 id="section"></h5>
<h5 id="gestión">Gestión</h5>
<p>La plataforma de gestión es utilizada por los proveedores para
interactuar con su comunidad de consumidores. La plataforma le debe
ofrecer a los proveedores las capacidades de manejo y configuración de
APIs.</p>
<p>La plataforma de gestión debe ofrecer:</p>
<ul>
<li><p>Manejo de API: Configuración y reconfiguración de APIs existentes
sin necesidad de redespliegues</p></li>
<li><p>Descubrimiento de APIs: Mecanismos para que los clientes obtengan
información de las APIs</p></li>
<li><p>Identificación de clientes (Manejo de llaves)</p></li>
<li><p>Información para la comunidad (foros, blogs, redes sociales, bases
de conocimiento, etc.)</p></li>
</ul>
<p>La plataforma de gestión ofrece adicionalmente documentación interactiva
generada a partir de la descripción del API, manejo de versiones, manejo
de los niveles de servicios y los cobros asociados</p>
<p>La plataforma de gestión les ofrece a los consumidores del API,
mecanismos para explorar y obtener información del Portafolio de APIs,
documentación del portafolio, manejo de credenciales y manejo de planes
de pago.</p>
<p>La plataforma de gestión deber centrarse en ofrecer servicios de:</p>
<ul>
<li><p>Documentación del portafolio de APIs</p></li>
<li><p>Soluciones basadas en el portafolio de APIs</p></li>
<li><p>Posibilidad de usar el API interactivamente</p></li>
<li><p>Ejemplos de soluciones / código</p></li>
<li><p>Herramientas de apoyo a los usuarios de las APIs</p></li>
</ul>
<h3 id="microservicios">Microservicios</h3>
<p>Una segunda tecnología que se muestra como el reemplazo del SOA
tradicional son los Microservicios, como componentes de software
independientes, que tienen como característica principal su capacidad de
despliegue autónomo, orientados a la nube y con mayor adaptación a
procesos de desarrollo de entrega continua y despliegue continuo.</p>
<p>La utilización de Microservicios en lugar de las aproximaciones basadas
en Servicios de alta granularidad, tipo SOA, sumado al uso de protocolos
de comunicación basados en la exposición de APIs tanto REST como
GraphQL, hacen que los tiempos de desarrollo y puesta en producción sean
menores. Principalmente, la característica de ser independientes en el
despliegue, facilita la modificación, cambio y evolución del software,
inclusive desarrollado en diferentes tecnologías o lenguajes de
programación.</p>
<h4 id="proceso-de-desarrollo">Proceso de desarrollo</h4>
<p>Uno de los elementos más críticos en las arquitecturas orientadas a
servicios y en los Microservicios como nuevo esquema de trabajo SOA, es
la identificación y diseño de los Microservicios. Las empresas
actualmente aplican diferentes estrategias para identificar los
servicios a desarrollar e implementar. Sin embargo, uno de los riesgos
más críticos tiene que ver con el crecimiento descontrolado de
Microservicios, que no tienen una alineación clara con el negocio.</p>
<p>En la actualidad el proceso de identificación y diseño de Microservicios
que se utiliza mayoritariamente, tiene que ver con el uso de
Domain-Driven Design (DDD) para la identificación de los Microservicios
y para la definición de los ecosistemas de servicios a desarrollar. A
nivel de diseño detallado de los Microservicios, se utiliza
principalmente la arquitectura hexagonal.</p>
<h4 id="domain-driven-design">Domain Driven Design</h4>
<p>El diseño orientado por dominio, busca que los servicios y
microservicios no necesariamente busquen maximizar su reutilización,
como se ha venido manteniendo en los últimos años. Por el contrario, en
el DDD es normal que los servicios no sean reutilizables entre unidades
de negocio, que manejan términos, conceptos y vocabularios
indepesndientes. En DDD, se busca tener servicios alineados con el
negocio, en lugar de reutilizar un mismo servicio en todas las unidades
de negocio, de esta forma se logra el desacoplamiento, un menor tiempo
de entrega y puesta en producción, así como el uso de técnicas de
integración y despliegue continuo.</p>
<figure>
<img src="./images/media/image1.png" style="width:3.70139in;height:2.63264in" />
</figure>
<p>En DDD la alineación con el negocio es lo fundamental, por eso, los
subdominios de negocio o procesos de negocio se relacionan con las
unidades de diseño, llamadas contextos acotados o <em>bounded context</em>s.</p>
<figure>
<img src="./images/media/image2.png" style="width:3.6875in;height:3.03403in" />
</figure>
<p>Una unidad de negocio puede tener varios contextos acotados, de forma
que varios servicios son identificados para poblar el portafolio de
servicios.</p>
<figure>
<img src="./images/media/image3.png" style="width:3.58125in;height:3.03333in" />
</figure>
<p>Finalmente, un contexto acotado, es a su vez, subdivido en agregados.
Los agregados tienen una estructura basada en entidades y objetos de
valor. Las entidades representan una operación de negocio indivisible.</p>
<figure>
<img src="./images/media/image4.png" style="width:3.26875in;height:3.1875in" />
</figure>
<p>En este esquema de trabajo, usualmente un agregado es un microservicio.
Esta técnica de identificación es mucho más precisa, que simplemente el
proponer microservicios vistos como pequeñas unidades de software, que
técnicamente cumplen con tener un tamaño de líneas de código pequeño,
pero que no tienen en cuenta la alineación con el negocio.</p>
<p>Al interior de un agregado, se identifican los siguientes elementos:</p>
<figure>
<img src="./images/media/image5.png" style="width:2.97847in;height:2.69583in" />
</figure>
<h4 id="arquitectura-hexagonal">Arquitectura Hexagonal</h4>
<p>Una vez se tienen identificados los microservicios, y definida su
estructura interna, el siguiente paso es identificar, los puntos de
interacción con el ecosistemas de servicios. La arquitectura hexagonal
sirve para definir estos puntos y para diseñar los mecanismos de
comunicación de los microservicios, por ejemplo APIs o colas de
comandos, así como para determinar los eventos que escuchará el
microservicios, los mensajes a procesar, los eventos que emite el
microservicios y la estrategia de almacenamiento de datos del
microservicio.</p>
<figure>
<img src="./images/media/image6.png" style="width:3.80208in;height:3.33819in" />
</figure>
<h3 id="buses-de-servicios-esb">Buses de servicios (ESB)</h3>
<p>Sin duda alguno los buses de servicio han sido la piedra angular en las
arquitecturas orientadas a servicios en los últimos años. La decisión de
arquitectura de orientarse a los servicios implica también que los
servicios deben poder ser localizados, que se debe poder intermediar la
comunicación e intercambio de datos entre ellos y que deben contar con
una infraestructura que les permita orquestar el llamado requerido entre
ellos para implementar lógica de negocio.</p>
<p>Los ESBs han sido fundamentales en la evolución de las arquitecturas
orientadas a servicios. Sin embargo, un reto crítico actualmente es la
decisión de cómo integrar los ESBs a las arquitecturas modernas, no
monolíticas y más basadas en tecnologías Web y microservicios.</p>
<figure>
<img src="./images/media/image7.png" style="width:4.81736in;height:3.4625in" />
</figure>
<h3 id="section-1"></h3>
<h3 id="section-2"></h3>
<h3 id="section-3"></h3>
<h3 id="section-4"></h3>
<h3 id="section-5"></h3>
<h3 id="section-6"></h3>
<h3 id="section-7"></h3>
<h3 id="section-8"></h3>
<h3 id="section-9"></h3>
<h3 id="tomado-de-httpswww.crosser.ioblogpostswhy-the-next-generation-enterprise-service-bus-esb-needs-to-be-intelligent">Tomado de: https://www.crosser.io/blog/posts/why-the-next-generation-enterprise-service-bus-esb-needs-to-be-intelligent/</h3>
<h3 id="section-10"></h3>
<p>En la anterior figura, se muestra la evolución que han tenido los ESBs.
La primera generación, caracterizada por ser infraestructura instalada
normalmente en el datacenter de las organizaciones. En esta generación
el apoyo a procesos ágiles de desarrollo y prácticas de DevOps era
prácticamente impensable.</p>
<h3 id="section-11"></h3>
<p>La segunda generación se basa en infraestructura como servicio, buses
desplegados tanto en los datacenters locales como en la nube, con
capacidades de intercambio de datos en formato SOAP e integración batch.</p>
<p>La tercera generación de buses, se basa en el despliegue en nubes
híbridas, manejo de diferentes tipos de comunicación, ya sea punto a
punto, mensajes, o corrientes de datos (streams). Quizás lo más
importante a resaltar es el cambio de comunicaciones bloqueantes
sincrónicas a comunicaciones basadas en eventos, pero sin los limitantes
de latencia de las plataformas de mensajería antiguas. En este caso,
hablamos de mecanismos de comunicación orientados a eventos, con
capacidades de procesamiento muy altas y con muy baja latencia.</p>
<h3 id="arquitecturas-orientadas-a-eventos">Arquitecturas Orientadas a Eventos</h3>
<p>Sin duda alguna el mecanismo de comunicación más utilizado en
arquitectura orientadas a componentes y servicios es el mecanismo
conocido como request-reply. Es decir, comunicaciones basadas en
transferencia sincrónica de información. Este mecanismo implica en
general, la comunicación entre un servicio consumidor y un servicio
proveedor. El servicio consumidor, debe inicialmente localizar al
servicio consumidor (posiblemente con ayuda de un ESB) y ejecutar una
petición al servicio proveedor. A través de protocolos como SOAP la
comunicación se establece y el intercambio de información comienza
(posiblemente en datos usando formatos en XML).</p>
<p>Este mecanismo de comunicación tiene ventajas, pero también presenta
desventajas. La principal ventaja es que se trata de una comunicación
sincrónica por lo que no es tan complicado seguir el flujo de control
entre los diferentes servicios. A este proceso se le conoce como
orquestación de servicios, es decir, el flujo de control iniciado por un
servicio cliente, que consume en un orden específico los servicios
proveedores. La desventaja de este esquema de comunicación es el manejo
del error y la disponibilidad. En caso de que un servicio proveedor no
esté disponible o falle en la mitad de una operación iniciada por un
consumidor, toda la transacción falla. En situaciones de negocio
críticas, este comportamiento es deseable, pero en otras ocasiones,
implica una falla en la disponibilidad de la solución.</p>
<p>Como medida de mitigación a la comunicación sincrónica basada en
comunicaciones tipo request-reply, surgen los mecanismos de
intermediación y comunicación basados en mensajes. Por su naturaleza,
estos mecanismos son esencialmente asíncronos.</p>
<p>En el esquema de comunicación basado en mensajes, tres conceptos son de
suma importancia: Eventos, Queries y Comandos.</p>
<p>Los eventos, en una Arquitectura orientada por eventos (EDA) representan
hechos cumplidos, que desean ser notificados de manera asíncrona a los
demás servicios participantes de una solución.</p>
<figure>
<img src="./images/media/image8.png" style="width:3.46667in;height:2.89583in" />
</figure>
<p>Las consultas, representan peticiones a un servicio, que no tienen
efecto de borde.</p>
<figure>
<img src="./images/media/image9.png" style="width:3.73889in;height:3.0625in" />
</figure>
<h3 id="section-12"></h3>
<p>Los comandos, representan una intención de cambio en el estado de la
solución. Los comandos son solicitudes que pueden o no ejecutarse, no se
tiene certeza de su cumplimiento. En cualquier caso, el resultado de
ejecución de un comando, puede tener como resultado un evento
notificando a los interesados el resultado obtenido.</p>
<h3 id="section-13"><img src="./images/media/image10.png" style="width:4.13264in;height:3.01319in" /></h3>
<h3 id="section-14"></h3>
<h3 id="section-15"></h3>
<h3 id="section-16"></h3>
<h3 id="section-17"></h3>
<h3 id="section-18"></h3>
<h3 id="section-19"></h3>
<h3 id="section-20"></h3>
<h3 id="section-21"></h3>
<h3 id="section-22"></h3>
<h3 id="section-23"></h3>
<h3 id="section-24"></h3>
<h3 id="section-25"></h3>
<p><img src="./images/media/image11.png" style="width:2.98681in;height:2.55833in" />A partir de estos tres conceptos, se
construyen soluciones desacopladas, que en su mayoría se comunican en
forma asíncrona. El concepto fundamental, es que no se tienen servicios
que realizan comunicaciones síncronas. Toda solicitud de realización de
un comando es transmitida como un mensaje mediante una cola de mensajes.
Los servicios proveedores reciben las peticiones, ejecutan los comandos
o consultas y emiten eventos como resultado. No se tiene ninguna
orquestación de servicios, solo coreografía de servicios desacoplado</p>
<h3 id="section-26"></h3>
<h3 id="section-27"></h3>
<h3 id="section-28"></h3>
<h3 id="section-29"></h3>
<h3 id="section-30"></h3>
<h3 id="section-31"></h3>
<h3 id="section-32"></h3>
<h3 id="section-33"></h3>
<h3 id="section-34"></h3>
<h3 id="section-35"></h3>
<p>La figura anterior, muestra el esquema de comunicación fundamental en
las arquitecturas orientadas a eventos. Para mejorar los tiempos de
respuesta, las aplicaciones suelen replicar parcialmente datos de otros
sistemas. Estos datos son utilizados solo para lectura. Debido al
retardo en la actualización de los datos, se habla de que existe
consistencia eventual entre los sistemas de información.</p>
<h3 id="section-36"></h3>
<h3 id="service-mesh">Service Mesh</h3>
<p>En los esquemas de comunicación sincrónica, donde los servicios
localizan otros servicios y envían peticiones sincrónicas (conteniendo
comandos o consultas). Uno de los problemas que pueden surgir, tienen
que ver con la necesidad de satisfacer diferentes requisitos de calidad,
como la seguridad, la disponibilidad y la escalabilidad. Varias de esos
requisitos se resuelven con diferentes componentes, como, por ejemplo,
los balanceadores de carga, herramientas de replicación y de
autorización y autenticación. Adicionalmente, cada servicio implementa
en su lógica, ciertas funcionalidades para manejar este tipo de
requisitos, haciendo la complejidad y el mantenimiento de las
aplicaciones más complejo. Este escenario se ilustra en la siguiente
figura.</p>
<figure>
<img src="./images/media/image12.png" style="width:2.98085in;height:1.32259in" />
</figure>
<p>Tomado de:
https://www.redhat.com/en/topics/microservices/what-is-a-service-mesh</p>
<p>En un esquema service mesh, cada servicio es acompañado de un proxy
(llamado sidecar), este proxy se encarga de gestionar toda la seguridad,
disponibilidad y escalabilidad, de forma que los servicios no tengan que
preocuparse por estos elementos. La siguiente figura ilustra esta idea.</p>
<figure>
<img src="./images/media/image13.png" style="width:3.05339in;height:1.29834in" />
</figure>
<p>Tomado de:
https://www.redhat.com/en/topics/microservices/what-is-a-service-mesh</p>
<p>La siguiente figura resume lo antes expuesto, donde además se ilustran
los dos elementos fundamentales de este esquema: data plane y control
plane.</p>
<p>El término data plane, se refiere a los proxies (sidecars) asociados a
cada microservicio. El control plane se encarga de gobernar los proxies
asociados a los microservicios.</p>
<figure>
<img src="./images/media/image14.png" style="width:4.04958in;height:1.74876in" />
</figure>
<p>Tomado de:
https://www.techtarget.com/searchitoperations/definition/service-mesh</p>
<h3 id="section-37"></h3>
<h3 id="plataforma-de-integración-híbrida-hip">Plataforma de Integración Híbrida (HIP)</h3>
<p>Sin duda alguna tanto las tecnologías basadas en APIs y consumos de
servicios síncronos han sido y seguirán siendo pieza clave en las
arquitecturas de integración y orquestación de servicios. Las
organizaciones han realizado inversiones altas en la instalación y
mantenimiento de infraestructura como ESBs sin contar las múltiples
soluciones que hoy día se manejan basadas en este esquema de
comunicación.</p>
<p>De otra parte, los mecanismos de sincronización y comunicación
asíncronos, basados primordialmente en colas de mensajes, se vienen
posicionando como una alternativa cada vez más seria a los buses de
servicios tradicionales.</p>
<p>Las plataformas de integración híbridas (HIP) se posicionan cada vez más
como una forma de conciliar las estrategias de integración tradicionales
y las nuevas tendencias orientadas a eventos. Estas plataformas
propenden por la transferencia de estado entre sistema de información
utilizando las plataformas de mensajería y la consulta de información de
forma sincrónica sobre copias con ventanas de consistencia (consistencia
eventual)</p>
<figure>
<img src="./images/media/image15.png" style="width:4.33132in;height:3.01989in" />
</figure>
<h3 id="section-38"></h3>
<h3 id="section-39"></h3>
<h3 id="hub-de-integración-digital-dih">Hub de Integración Digital (DIH)</h3>
<p>Un DIH es un estilo de arquitectura que busca desacoplar sistemas de
información en un ecosistema de TI. No solo a nivel de flujo de control
sino también a nivel de datos, adicionando una capa de datos de muy baja
latencia. Adicionalmente se propone una mezcla de los tipos de
conectores expuestos anteriormente. En primer lugar, se cuenta con un
API de desacoplamiento. Los DIH permiten trabajar en esquemas híbridos,
con despliegues on-premises y despliegues en cloud.</p>
<figure>
<img src="./images/media/image16.png" style="width:4.07246in;height:3.01388in" />
</figure>
<p>Tomado de: https://www.gigaspaces.com/blog/digital-integration-hub-dih/</p>
<p>Esta arquitectura permite la práctica de técnicas DevOps, como la
integración y despliegue continuo. Adicionalmente, esta arquitectura se
enfoca en la recolección de datos desde múltiples fuentes de datos.</p>
<p>El término DIH fue propuesto por Gartner unos años atrás. En las
siguiente figuras, podemos apreciar la comparación realizada en el
informe original de Gartner, entre una arquitectura tradicional basada
en APIS en la primera figura y una arquitectura basada en DIH en la
segunda figura.</p>
<figure>
<img src="./images/media/image17.png" style="width:3.86468in;height:2.42409in" />
</figure>
<p>Tomado de:
https://mindovermessaging.com/2022/03/29/maximising-your-apis-with-a-digital-integration-hub/</p>
<figure>
<img src="./images/media/image18.png" style="width:3.89652in;height:2.94861in" />
</figure>
<p>Tomado de:
https://mindovermessaging.com/2022/03/29/maximising-your-apis-with-a-digital-integration-hub/</p>
<p>En el esquema basado en DIH la diferencia fundamental radica en una
nueva capa ubicada entre el API Gateway y los microservicios y la
plataforma híbrida de integración. Esta capa denominada High Performance
Data Store (HPDS). Esta capa se alimenta a partir de la plataforma de
integración, usualmente utilizando un esquema basado en eventos.</p>
<h1 id="fase-2-soa-objetivo">Fase 2: SOA Objetivo</h1>
<h1 id="contenido-de-los-productos-contractuales-181-2020-3">Contenido de los Productos Contractuales, 181-2020</h1>
<h1 id="producto-8-pr8.-arquitectura-soa-candidata-para-fna">Producto 8: PR8. Arquitectura SOA Candidata para FNA</h1>
<p>La arquitectura SOA candidata para el FNA es la continuación de la referencia SOA desarrollada en la Fase 1 del presente diagnóstico. Esta nueva edición de la arquitectura es la base para planear el fortalecimiento SOA y de las capacidades de negocio del segmento de la empresa FNA. La arquitectura candidata recoge principalmente los análisis previos de situación actual SOA del Fondo, análisis de madurez SOA, el análisis de vigilancia tecnológica y estilos SOA, y el de la comparativa con el sector de la industria.</p>
<p><strong>Nota</strong>: los análisis de este producto están dirigidos a cumplir los objetivos del proyecto SOA: dependencia de proveedor (OBJ1), fortaleza SOA de las aplicaciones (OBJ2), y tiempo de mercado (OBJ3).</p>
<p><br></p>
<h2 id="justificación-3">Justificación</h2>
<p>La arquitectura SOA candidata del FNA sirve de base para la planeación de cambios de cierre de brecha de la situación actual SOA del Fondo (ver Fase 1).</p>
<h2 id="contenidos-3">Contenidos</h2>
<ol type="1">
<li>Arquitectura de referencia SOA FNA, versión 2.0</li>
<li>Consideraciones para gobierno y adaptabilidad de la arquitectura 2.0</li>
<li>Administración de requerimientos de arquitectura para evolución y mantenimiento</li>
<li>Procedimientos de evaluación de la arquitectura candidata FNA (req. no funcionales)</li>
</ol>
<p><br></p>
<h2 id="criterios-de-aceptación-3">Criterios de Aceptación</h2>
<ul>
<li>Arquitectura de referencia SOA FNA, versión 2.0</li>
<li>Articulación con gobierno SOA del FNA</li>
</ul>
<hr />
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Arquitectura SOA Candidata para FNA: <strong>Arquitectura de Referencia. Versión 2.0</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Tecnologías, Arquitectura de referencia, Candidata, Hoja de ruta</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">N003a Vista Segmento SOA FNA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="arquitectura-de-referencia.-versión-2">Arquitectura de Referencia. Versión 2</h2>
<p>Este documento presenta la visión general de la arquitectura de
referencia del FNA. Contiene propuestas a futuro sobre los cambios y
adiciones sugeridas con respecto a la arquitectura de referencia actual.</p>
<p><br></p>
<h2 id="vista-funcional">Vista Funcional</h2>
<h3 id="blueprint-general---asis">Blueprint General - ASIS</h3>
<p>A continuación se presenta la arquitectura de referencia ASIS. El
propósito es recordar el esquema actual para poderlo comparar con la
arquitectura propuesta.</p>
<figure>
<img src="images/arq/media/image1.png" style="width:12in;height:7in" />
</figure>
<p>Fondo Nacional del Ahorro - Arquitectura de Referencia</p>
<p><br></p>
<h3 id="blueprint-general---tobe">Blueprint General - TOBE</h3>
<p>A continuación se presenta la arquitectura de referencia propuesta</p>
<p><strong>Nivel de detalle 1</strong></p>
<figure>
<img src="images/arq/media/image1.1.png" style="width:13in;height:7in" />
</figure>
<p><br>
<strong>Nivel de detalle 2</strong></p>
<figure>
<img src="images/arq/media/image2.png" style="width:13in;height:7in" />
</figure>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Tema</th>
<th>Arquitectura SOA Candidata para FNA: <strong>Arquitectura de Datos Candidata FNA</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Palabras clave</td>
<td>SOA, Tecnologías, Arquitectura de referencia, Candidata, Hoja de ruta</td>
</tr>
<tr class="even">
<td>Autor</td>
<td></td>
</tr>
<tr class="odd">
<td>Fuente</td>
<td></td>
</tr>
<tr class="even">
<td>Version</td>
<td><strong>9b3a97c</strong> del 06 Feb 2023</td>
</tr>
<tr class="odd">
<td>Vínculos</td>
<td><a href="N03a%a20Vsta%20aSegenta%20SOA%20FNA.md">N003a Vista Segmento SOA FNA</a></td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="arquitectura-de-datos-candidata-fna">Arquitectura de Datos Candidata FNA</h2>
<p>Para la arquitectura SOA objetivo se propone un enfoque conocido como malla de
datos, este es un cambio de paradigma que permite pensar en los datos
como un producto. La malla de datos introduce cambios organizativos y de
procesos que las empresas necesitarán para gestionar los datos como un
activo de capital tangible del negocio.</p>
<p>Una malla de datos tiene como objetivo que los datos sean más accesibles
y estén disponibles para los usuarios, conectando directamente a
propietarios, los productores y los consumidores de datos. La malla de
datos tiene como objetivo mejorar los resultados empresariales de las
soluciones centradas en los datos, así como impulsar la adopción de
arquitecturas de datos modernas.</p>
<h3 id="pilares-de-la-malla-de-datos-data-mesh">Pilares de la malla de datos (Data Mesh)</h3>
<figure>
<img src="./images/d1/media/image1.png" style="width:6.1375in;height:3.08194in" />
</figure>
<h3 id="arquitectura-to-be">Arquitectura To Be</h3>
<figure>
<img src="./images/d1/media/image2.png" style="width:6.1375in;height:3.55208in" />
</figure>
<h3 id="principales-características">Principales Características</h3>
<p><strong>Propiedad impulsada por el dominio</strong>: el primer principio de un data
mesh es transferir el poder de los datos y la propiedad a las manos de
los equipos de dominio (es decir departamentos, unidades de negocio,
etc.). Ellos serán los dueños de los datos de un extremo a otro, y
podrán asegurarse de tener desde las fuentes correctas hasta los
procesamientos necesarios y la entrega de los datos para que otros
equipos de dominio los aprovechen como productos</p>
<p><strong>Datos como producto:</strong> los equipos de dominio son responsables de los
datos y también de los productos de datos resultantes. El objetivo es
lograr que cada “producto de datos” sea descubierto y utilizable por los
consumidores y otros equipos de dominio, y el propietario del dominio es
responsable de mantener y actualizar (o desaprobar) estos productos para
garantizar la calidad y la precisión.</p>
<p><strong>Infraestructura de autoservicio</strong>: que todo sea “autoservicio” hace
que nos olvidemos para siempre de las tecnologías complejas y las
habilidades de nicho. El Data mesh se basa, por principio, en una
gestión de datos mediante una plataforma común y un conjunto de
herramientas que cualquier equipo de dominio pueda aprovechar.</p>
<p><strong>Gobernanza federada</strong>: si de verdad queremos eliminar controles de
acceso necesitamos un equilibrio entre las políticas y controles de
gobernanza global y la posibilidad de dominio y creación de productos.
Esto es lo que llamamos gobernanza federada y en la práctica es
fundamental para garantizar la privacidad, el cumplimiento y la
posibilidad de escalar.</p>
<h1 id="fase-2-soa-objetivo-1">Fase 2: SOA Objetivo</h1>
<h1 id="contenido-de-los-productos-contractuales-181-2020-4">Contenido de los Productos Contractuales, 181-2020</h1>
<h1 id="producto-9-pr9.-portafolio-de-inciativas-y-brechas">Producto 9: PR9. Portafolio de Inciativas y Brechas</h1>
<p>La técnica del portafolio de brechas es utilizada en el desarrollo de este ejercicio de diagnóstico SOA del FNA para analizar la situación actual SOA (Fase 1 del proyecto) desde la perspectiva de proyectos ejecutables. La idea principal del análisis de brecha es resaltar los proyectos o ítems omitidos, o por definir, entre la situación actual SOA del FNA y la situación objetivo, incluso cuando esta última está todavía en evolución. Lo anterior da origen al portafolio de iniciativas priorizadas que ser ejecutadas cierra las brechas analizadas.</p>
<p><strong>Nota</strong>: los análisis de este producto están dirigidos a cumplir los objetivos del proyecto SOA: dependencia de proveedor (OBJ1), fortaleza SOA de las aplicaciones (OBJ2), y tiempo de mercado (OBJ3).</p>
<p><br></p>
<h2 id="justificación-4">Justificación</h2>
<p>Asegurar que la arquitectura SOA del Fondo apegada a la <a href="vistadesegmento.md">Vista de Segmento FNA</a> soporte al procesamiento de información, a los sistemas de información, a las capacidades de negocio, y tecnologías requeridas para cumplir los objetivos de este ejercicio de diagnóstico SOA. Dar continuidad y orden al impacto y realiación de los cambios entre evoluciones de la arquitectura SOA.</p>
<h2 id="contenidos-4">Contenidos</h2>
<ol type="1">
<li>Arquitectura SOA candidata para el segmento FNA (vista de segmento)</li>
<li>Matriz de brechas de las partes del segmento FNA</li>
<li>Bloques de cambios para el segmento FNA: ítems por retener, rediseñar, actualizar, retirar</li>
<li>Análisis de impacto y dependencia entre los cambios en el segmento de la empresa</li>
<li>Ficha descriptiva de iniciativas de mejora para el segmento FNA (justificación)</li>
<li>Hoja de ruta preliminar hacia un objetivo de mejora</li>
</ol>
<p><br></p>
<h2 id="criterios-de-aceptación-4">Criterios de Aceptación</h2>
<ul>
<li>Lista de cambios para el segmento FNA: ítems incluídos, por mejorar, nuevos y eliminados</li>
<li>Hoja de ruta preliminar hacia un objetivo de mejora</li>
</ul>
<hr />
<!-- default theme -->

<style>
  /* import google fonts */
  @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
  @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

  /* -------------------------------------------------- */
  /* global */
  /* -------------------------------------------------- */

  /* all elements */
  * {
    /* force sans-serif font unless specified otherwise */
    font-family: "Open Sans", "Helvetica", sans-serif;

    /* prevent text inflation on some mobile browsers */
    -webkit-text-size-adjust: none !important;
    -moz-text-size-adjust: none !important;
    -o-text-size-adjust: none !important;
    text-size-adjust: none !important;
  }

  @media only screen {
    /* "page" element */
    body {
      position: relative;
      box-sizing: border-box;
      font-size: 12pt;
      line-height: 1.5;
      max-width: 8.5in;
      margin: 20px auto;
      padding: 40px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* "page" element */
    body {
      padding: 20px;
      margin: 0;
      border-radius: 0;
      border: none;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
      background: none;
    }
  }

  /* -------------------------------------------------- */
  /* headings */
  /* -------------------------------------------------- */

  /* all headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin: 20px 0;
    padding: 0;
    font-weight: bold;
  }

  /* biggest heading */
  h1 {
    margin: 40px 0;
    text-align: center;
  }

  /* second biggest heading */
  h2 {
    margin-top: 30px;
    padding-bottom: 5px;
    border-bottom: solid 1px #bdbdbd;
  }

  /* heading font sizes */
  h1 {
    font-size: 2em;
  }
  h2 {
    font-size: 1.5em;
  }
  h3 {
    font-size: 1.35em;
  }
  h4 {
    font-size: 1.25em;
  }
  h5 {
    font-size: 1.15em;
  }
  h6 {
    font-size: 1em;
  }

  /* -------------------------------------------------- */
  /* manuscript header */
  /* -------------------------------------------------- */

  /* manuscript title */
  header > h1 {
    margin: 0;
  }

  /* manuscript title caption text (ie "automatically generated on") */
  header + p {
    text-align: center;
    margin-top: 10px;
  }

  /* -------------------------------------------------- */
  /* text elements */
  /* -------------------------------------------------- */

  /* links */
  a {
    color: #2196f3;
    overflow-wrap: break-word;
  }

  /* superscripts and subscripts */
  sub,
  sup {
    /* prevent from affecting line height */
    line-height: 0;
  }

  /* unordered and ordered lists*/
  ul,
  ol {
    padding-left: 20px;
  }

  /* class for styling text semibold */
  .semibold {
    font-weight: 600;
  }

  /* class for styling elements horizontally left aligned */
  .left {
    display: block;
    text-align: left;
    margin-left: auto;
    margin-right: 0;
    justify-content: left;
  }

  /* class for styling elements horizontally centered */
  .center {
    display: block;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    justify-content: center;
  }

  /* class for styling elements horizontally right aligned */
  .right {
    display: block;
    text-align: right;
    margin-left: 0;
    margin-right: auto;
    justify-content: right;
  }

  /* -------------------------------------------------- */
  /* section elements */
  /* -------------------------------------------------- */

  /* horizontal divider line */
  hr {
    border: none;
    height: 1px;
    background: #bdbdbd;
  }

  /* paragraphs, horizontal dividers, figures, tables, code */
  p,
  hr,
  figure,
  table,
  pre {
    /* treat all as "paragraphs", with consistent vertical margins */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* figures */
  /* -------------------------------------------------- */

  /* figure */
  figure {
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure caption */
  figcaption {
    padding: 0;
    padding-top: 10px;
  }

  /* figure image element */
  figure > img,
  figure > svg {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure auto-number */
  img + figcaption > span:first-of-type,
  svg + figcaption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* tables */
  /* -------------------------------------------------- */

  /* table */
  table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* table cells */
  th,
  td {
    border: solid 1px #bdbdbd;
    padding: 10px;
    /* squash table if too wide for page by forcing line breaks */
    overflow-wrap: break-word;
    word-break: break-word;
  }

  /* header row and even rows */
  th,
  tr:nth-child(2n) {
    background-color: #fafafa;
  }

  /* odd rows */
  tr:nth-child(2n + 1) {
    background-color: #ffffff;
  }

  /* table caption */
  caption {
    text-align: left;
    padding: 0;
    padding-bottom: 10px;
  }

  /* table auto-number */
  table > caption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* code */
  /* -------------------------------------------------- */

  /* multi-line code block */
  pre {
    padding: 10px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
    break-inside: avoid;
    text-align: left;
  }

  /* inline code, ie code within normal text */
  :not(pre) > code {
    padding: 0 4px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
  }

  /* code text */
  /* apply all children, to reach syntax highlighting sub-elements */
  code,
  code * {
    /* force monospace font */
    font-family: "Source Code Pro", "Courier New", monospace;
  }

  /* -------------------------------------------------- */
  /* quotes */
  /* -------------------------------------------------- */

  /* quoted text */
  blockquote {
    margin: 0;
    padding: 0;
    border-left: 4px solid #bdbdbd;
    padding-left: 16px;
    break-inside: avoid;
  }

  /* -------------------------------------------------- */
  /* banners */
  /* -------------------------------------------------- */

  /* info banners */
  .banner {
    box-sizing: border-box;
    display: block;
    position: relative;
    width: 100%;
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 20px;
    text-align: center;
  }

  /* paragraph in banner */
  .banner > p {
    margin: 0;
  }

  /* -------------------------------------------------- */
  /* highlight colors */
  /* -------------------------------------------------- */

  .white {
    background: #ffffff;
  }
  .lightgrey {
    background: #eeeeee;
  }
  .grey {
    background: #757575;
  }
  .darkgrey {
    background: #424242;
  }
  .black {
    background: #000000;
  }
  .lightred {
    background: #ffcdd2;
  }
  .lightyellow {
    background: #ffecb3;
  }
  .lightgreen {
    background: #dcedc8;
  }
  .lightblue {
    background: #e3f2fd;
  }
  .lightpurple {
    background: #f3e5f5;
  }
  .red {
    background: #f44336;
  }
  .orange {
    background: #ff9800;
  }
  .yellow {
    background: #ffeb3b;
  }
  .green {
    background: #4caf50;
  }
  .blue {
    background: #2196f3;
  }
  .purple {
    background: #9c27b0;
  }
  .white,
  .lightgrey,
  .lightred,
  .lightyellow,
  .lightgreen,
  .lightblue,
  .lightpurple,
  .orange,
  .yellow,
  .white a,
  .lightgrey a,
  .lightred a,
  .lightyellow a,
  .lightgreen a,
  .lightblue a,
  .lightpurple a,
  .orange a,
  .yellow a {
    color: #000000;
  }
  .grey,
  .darkgrey,
  .black,
  .red,
  .green,
  .blue,
  .purple,
  .grey a,
  .darkgrey a,
  .black a,
  .red a,
  .green a,
  .blue a,
  .purple a {
    color: #ffffff;
  }

  /* -------------------------------------------------- */
  /* buttons */
  /* -------------------------------------------------- */

  /* class for styling links like buttons */
  .button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin: 5px;
    padding: 10px 20px;
    font-size: 0.75em;
    font-weight: 600;
    text-transform: uppercase;
    text-decoration: none;
    letter-spacing: 1px;
    background: none;
    color: #2196f3;
    border: solid 1px #bdbdbd;
    border-radius: 5px;
  }

  /* buttons when hovered */
  .button:hover:not([disabled]),
  .icon_button:hover:not([disabled]) {
    cursor: pointer;
    background: #f5f5f5;
  }

  /* buttons when disabled */
  .button[disabled],
  .icon_button[disabled] {
    opacity: 0.35;
    pointer-events: none;
  }

  /* class for styling buttons containg only single icon */
  .icon_button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-decoration: none;
    margin: 0;
    padding: 0;
    background: none;
    border-radius: 5px;
    border: none;
    width: 20px;
    height: 20px;
    min-width: 20px;
    min-height: 20px;
  }

  /* icon button inner svg image */
  .icon_button > svg {
    height: 16px;
  }

  /* -------------------------------------------------- */
  /* icons */
  /* -------------------------------------------------- */

  /* class for styling icons inline with text */
  .inline_icon {
    height: 1em;
    position: relative;
    top: 0.125em;
  }

  /* -------------------------------------------------- */
  /* references */
  /* -------------------------------------------------- */

  .csl-entry {
    margin-top: 15px;
    margin-bottom: 15px;
  }

  /* -------------------------------------------------- */
  /* print control */
  /* -------------------------------------------------- */

  @media print {
    @page {
      /* suggested printing margin */
      margin: 0.5in;
    }

    /* document and "page" elements */
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    /* "page" element */
    body {
      font-size: 11pt !important;
      line-height: 1.35;
    }

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      margin: 15px 0;
    }

    /* figures and tables */
    figure,
    table {
      font-size: 0.85em;
    }

    /* table cells */
    th,
    td {
      padding: 5px;
    }

    /* shrink font awesome icons */
    i.fas,
    i.fab,
    i.far,
    i.fal {
      transform: scale(0.85);
    }

    /* decrease banner margins */
    .banner {
      margin-top: 15px;
      margin-bottom: 15px;
      padding: 15px;
    }

    /* class for centering an element vertically on its own page */
    .page_center {
      margin: auto;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      vertical-align: middle;
      break-before: page;
      break-after: page;
    }

    /* always insert a page break before the element */
    .page_break_before {
      break-before: page;
    }

    /* always insert a page break after the element */
    .page_break_after {
      break-after: page;
    }

    /* avoid page break before the element */
    .page_break_before_avoid {
      break-before: avoid;
    }

    /* avoid page break after the element */
    .page_break_after_avoid {
      break-after: avoid;
    }

    /* avoid page break inside the element */
    .page_break_inside_avoid {
      break-inside: avoid;
    }
  }

  /* -------------------------------------------------- */
  /* override pandoc css quirks */
  /* -------------------------------------------------- */

  .sourceCode {
    /* prevent unsightly overflow in wide code blocks */
    overflow: auto !important;
  }

  div.sourceCode {
    /* prevent background fill on top-most code block  container */
    background: none !important;
  }

  .sourceCode * {
    /* force consistent line spacing */
    line-height: 1.5 !important;
  }

  div.sourceCode {
    /* style code block margins same as <pre> element */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* tablenos */
  /* -------------------------------------------------- */

  /* tablenos wrapper */
  .tablenos {
    width: 100%;
    margin: 20px 0;
  }

  .tablenos > table {
    /* move margins from table to table_wrapper to allow margin collapsing */
    margin: 0;
  }

  @media only screen {
    /* tablenos wrapper */
    .tablenos {
      /* show scrollbar on tables if necessary to prevent overflow */
      overflow-x: auto !important;
    }

    .tablenos th,
    .tablenos td {
      overflow-wrap: unset !important;
      word-break: unset !important;
    }

    /* table in wrapper */
    .tablenos table,
    .tablenos table * {
      /* don't break table words */
      overflow-wrap: normal !important;
    }
  }
</style>
<!-- 
    Plugin Core

    Functions needed for and shared across all first-party plugins.
-->

<script>
  // get element that is target of hash (from link element or url)
  function getHashTarget(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector(`[id="${id}"]`);
    if (!target) return;

    // if figure or table, modify target to get expected element
    if (id.indexOf("fig:") === 0) target = target.querySelector("figure");
    if (id.indexOf("tbl:") === 0) target = target.querySelector("table");

    return target;
  }

  // get position/dimensions of element or viewport
  function getRectInView(element) {
    let rect = {};
    rect.left = 0;
    rect.top = 0;
    rect.right = document.documentElement.clientWidth;
    rect.bottom = document.documentElement.clientHeight;
    let style = {};

    if (element instanceof HTMLElement) {
      rect = element.getBoundingClientRect();
      style = window.getComputedStyle(element);
    }

    const margin = {};
    margin.left = parseFloat(style.marginLeftWidth) || 0;
    margin.top = parseFloat(style.marginTopWidth) || 0;
    margin.right = parseFloat(style.marginRightWidth) || 0;
    margin.bottom = parseFloat(style.marginBottomWidth) || 0;

    const border = {};
    border.left = parseFloat(style.borderLeftWidth) || 0;
    border.top = parseFloat(style.borderTopWidth) || 0;
    border.right = parseFloat(style.borderRightWidth) || 0;
    border.bottom = parseFloat(style.borderBottomWidth) || 0;

    const newRect = {};
    newRect.left = rect.left + margin.left + border.left;
    newRect.top = rect.top + margin.top + border.top;
    newRect.right = rect.right + margin.right + border.right;
    newRect.bottom = rect.bottom + margin.bottom + border.bottom;
    newRect.width = newRect.right - newRect.left;
    newRect.height = newRect.bottom - newRect.top;

    return newRect;
  }

  // get position of element relative to page
  function getRectInPage(element) {
    const rect = getRectInView(element);
    const body = getRectInView(document.body);

    const newRect = {};
    newRect.left = rect.left - body.left;
    newRect.top = rect.top - body.top;
    newRect.right = rect.right - body.left;
    newRect.bottom = rect.bottom - body.top;
    newRect.width = rect.width;
    newRect.height = rect.height;

    return newRect;
  }

  // get closest element before specified element that matches query
  function firstBefore(element, query) {
    while (element && element !== document.body && !element.matches(query))
      element = element.previousElementSibling || element.parentNode;

    return element;
  }

  // check if element is part of collapsed heading
  function isCollapsed(element) {
    while (element && element !== document.body) {
      if (element.dataset.collapsed === "true") return true;
      element = element.parentNode;
    }
    return false;
  }

  // expand any collapsed parent containers of element if necessary
  function expandElement(element) {
    if (isCollapsed(element)) {
      // accordion plugin
      const heading = firstBefore(element, "h2");
      if (heading) heading.click();
      // details/summary HTML element
      const summary = firstBefore(element, "summary");
      if (summary) summary.click();
    }
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);

    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // get list of elements after a start element up to element matching query
  function nextUntil(element, query, exclude) {
    const elements = [];
    while (((element = element.nextElementSibling), element)) {
      if (element.matches(query)) break;
      if (!element.matches(exclude)) elements.push(element);
    }
    return elements;
  }
</script>
<!--
  Accordion Plugin

  Allows sections of content under h2 headings to be collapsible.
-->

<script type="module">
  // whether to always start expanded ('false'), always start collapsed
  // ('true'), or start collapsed when screen small ('auto')
  const startCollapsed = "auto";

  // start script
  function start() {
    // run through each <h2> heading
    const headings = document.querySelectorAll("h2");
    for (const heading of headings) {
      addArrow(heading);

      // start expanded/collapsed based on option
      if (
        startCollapsed === "true" ||
        (startCollapsed === "auto" && isSmallScreen()) ||
        heading.dataset.collapsed === "true"
      )
        collapseHeading(heading);
      else expandElement(heading);
    }

    // attach hash change listener to window
    window.addEventListener("hashchange", onHashChange);
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) goToElement(target);
  }

  // add arrow to heading
  function addArrow(heading) {
    // add arrow button
    const arrow = document.createElement("button");
    arrow.innerHTML = document.querySelector(".icon_angle_down").innerHTML;
    arrow.classList.add("icon_button", "accordion_arrow");
    heading.insertBefore(arrow, heading.firstChild);

    // attach click listener to heading and button
    heading.addEventListener("click", onHeadingClick);
    arrow.addEventListener("click", onArrowClick);
  }

  // determine if on mobile-like device with small screen
  function isSmallScreen() {
    return Math.min(window.innerWidth, window.innerHeight) < 480;
  }

  // when <h2> heading is clicked
  function onHeadingClick(event) {
    // only collapse if <h2> itself is target of click (eg, user did
    // not click on anchor within <h2>)
    if (event.target === this) toggleCollapse(this);
  }

  // when arrow button is clicked
  function onArrowClick() {
    toggleCollapse(this.parentNode);
  }

  // collapse section if expanded, expand if collapsed
  function toggleCollapse(heading) {
    if (heading.dataset.collapsed === "false") collapseHeading(heading);
    else expandElement(heading);
  }

  // elements to exclude from collapse, such as table of contents panel,
  // hypothesis panel, etc
  const exclude = "#toc_panel, div.annotator-frame, #lightbox_overlay";

  // collapse section
  function collapseHeading(heading) {
    heading.setAttribute("data-collapsed", "true");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "true");
  }

  // expand section
  function expandElement(heading) {
    heading.setAttribute("data-collapsed", "false");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "false");
  }

  // get list of elements between this <h2> and next <h2> or <h1>
  // ("children" of the <h2> section)
  function getChildren(heading) {
    return nextUntil(heading, "h2, h1", exclude);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
  <!-- modified from: https://fontawesome.com/icons/angle-down -->
  <svg width="16" height="16" viewBox="0 0 448 512">
    <path
      fill="currentColor"
      d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* accordion arrow button */
    .accordion_arrow {
      margin-right: 10px;
    }

    /* arrow icon when <h2> data-collapsed attribute true */
    h2[data-collapsed="true"] > .accordion_arrow > svg {
      transform: rotate(-90deg);
    }

    /* all elements (except <h2>'s) when data-collapsed attribute true */
    *:not(h2)[data-collapsed="true"] {
      display: none;
    }

    /* accordion arrow button when hovered and <h2>'s when hovered */
    .accordion_arrow:hover,
    h2[data-collapsed="true"]:hover,
    h2[data-collapsed="false"]:hover {
      cursor: pointer;
    }
  }

  /* always hide accordion arrow button on print */
  @media only print {
    .accordion_arrow {
      display: none;
    }
  }
</style>
<!--
  Anchors Plugin

  Adds an anchor next to each of a certain type of element that provides a
  human-readable url to that specific item/position in the document (e.g.
  "manuscript.html#abstract"). It also makes it such that scrolling out of view
  of a target removes its identifier from the url.
-->

<script type="module">
  // which types of elements to add anchors next to, in "document.querySelector"
  // format
  const typesQuery =
    'h1, h2, h3, div[id^="fig:"], div[id^="tbl:"], span[id^="eq:"]';

  // start script
  function start() {
    // add anchor to each element of specified types
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) addAnchor(element);

    // attach scroll listener to window
    window.addEventListener("scroll", onScroll);
  }

  // when window is scrolled
  function onScroll() {
    // if url has hash and user has scrolled out of view of hash
    // target, remove hash from url
    const tolerance = 100;
    const target = getHashTarget();
    if (target) {
      if (
        target.getBoundingClientRect().top > window.innerHeight + tolerance ||
        target.getBoundingClientRect().bottom < 0 - tolerance
      )
        history.pushState(null, null, " ");
    }
  }

  // add anchor to element
  function addAnchor(element) {
    let addTo; // element to add anchor button to

    // if figure or table, modify withId and addTo to get expected
    // elements
    if (element.id.indexOf("fig:") === 0) {
      addTo = element.querySelector("figcaption");
    } else if (element.id.indexOf("tbl:") === 0) {
      addTo = element.querySelector("caption");
    } else if (element.id.indexOf("eq:") === 0) {
      addTo = element.querySelector(".eqnos-number");
    }

    addTo = addTo || element;
    const id = element.id || null;

    // do not add anchor if element doesn't have assigned id.
    // id is generated by pandoc and is assumed to be unique and
    // human-readable
    if (!id) return;

    // create anchor button
    const anchor = document.createElement("a");
    anchor.innerHTML = document.querySelector(".icon_link").innerHTML;
    anchor.title = "Link to this part of the document";
    anchor.classList.add("icon_button", "anchor");
    anchor.dataset.ignore = "true";
    anchor.href = "#" + id;
    addTo.appendChild(anchor);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- link icon -->

<template class="icon_link">
  <!-- modified from: https://fontawesome.com/icons/link -->
  <svg width="16" height="16" viewBox="0 0 512 512">
    <path
      fill="currentColor"
      d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* anchor button */
    .anchor {
      opacity: 0;
      margin-left: 5px;
    }

    /* anchor buttons within <h2>'s */
    h2 .anchor {
      margin-left: 10px;
    }

    /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
    *:hover > .anchor,
    .anchor:hover,
    .anchor:focus {
      opacity: 1;
    }

    /* anchor button when hovered */
    .anchor:hover {
      cursor: pointer;
    }
  }

  /* always show anchor button on devices with no mouse/hover ability */
  @media (hover: none) {
    .anchor {
      opacity: 1;
    }
  }

  /* always hide anchor button on print */
  @media only print {
    .anchor {
      display: none;
    }
  }
</style>
<!-- 
    Attributes Plugin

    Allows arbitrary HTML attributes to be attached to (almost) any element.
    Place an HTML comment inside or next to the desired element with the content:
    $attribute="value"
-->

<script type="module">
  // start script
  function start() {
    // get list of comments in document
    const comments = findComments();

    for (const comment of comments)
      if (comment.parentElement)
        addAttributes(comment.parentElement, comment.nodeValue.trim());
  }

  // add html attributes to specified element based on string of
  // html attributes and values
  function addAttributes(element, text) {
    // regex's for finding attribute/value pairs in the format of
    // attribute="value" or attribute='value
    const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
    const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

    // loop through attribute/value pairs
    let match;
    while ((match = text.match(regex2) || text.match(regex1))) {
      // get attribute and value from regex capture groups
      let attribute = match[1];
      let value = match[2];

      // remove from string
      text = text.substring(match.index + match[0].length);

      if (!attribute || !value) break;

      // set attribute of parent element
      try {
        element.setAttribute(attribute, value);
      } catch (error) {
        console.log(error);
      }

      // special case for colspan
      if (attribute === "colspan") removeTableCells(element, value);
    }
  }

  // get list of comment elements in document
  function findComments() {
    const comments = [];

    // iterate over comment nodes in document
    function acceptNode(node) {
      return NodeFilter.FILTER_ACCEPT;
    }
    const iterator = document.createNodeIterator(
      document.body,
      NodeFilter.SHOW_COMMENT,
      acceptNode
    );
    let node;
    while ((node = iterator.nextNode())) comments.push(node);

    return comments;
  }

  // remove certain number of cells after specified cell
  function removeTableCells(cell, number) {
    number = parseInt(number);
    if (!number) return;

    // remove elements
    for (; number > 1; number--) {
      if (cell.nextElementSibling) cell.nextElementSibling.remove();
    }
  }

  // start script on DOMContentLoaded instead of load to ensure this plugins
  // runs before other plugins
  window.addEventListener("DOMContentLoaded", start);
</script>
<!--
  Jump to First Plugin

  Adds a button next to each reference entry, figure, and table that jumps the
  page to the first occurrence of a link to that item in the manuscript.
-->

<script type="module">
  // whether to add buttons next to reference entries
  const references = "true";
  // whether to add buttons next to figures
  const figures = "true";
  // whether to add buttons next to tables
  const tables = "true";

  // start script
  function start() {
    if (references !== "false")
      makeButtons(`div[id^="ref-"]`, ".csl-left-margin", "reference");
    if (figures !== "false")
      makeButtons(`div[id^="fig:"]`, "figcaption", "figure");
    if (tables !== "false") makeButtons(`div[id^="tbl:"]`, "caption", "table");
  }

  // when jump button clicked
  function onButtonClick() {
    const first = getFirstOccurrence(this.dataset.id);
    if (!first) return;

    // update url hash so navigating "back" in history will return user to button
    window.location.hash = this.dataset.id;
    // scroll to link
    const timeout = function () {
      goToElement(first, window.innerHeight * 0.5);
    };
    window.setTimeout(timeout, 0);
  }

  // get first occurrence of link to item in document
  function getFirstOccurrence(id) {
    let query = "a";
    query += '[href="#' + id + '"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelector(query);
  }

  // add button next to each reference entry, figure, or table
  function makeButtons(query, containerQuery, subject) {
    const elements = document.querySelectorAll(query);
    for (const element of elements) {
      const id = element.id;
      const buttonContainer = element.querySelector(containerQuery);
      const first = getFirstOccurrence(id);

      // if can't find link to reference or place to put button, ignore
      if (!first || !buttonContainer) continue;

      // make jump button
      let button = document.createElement("button");
      button.classList.add("icon_button", "jump_arrow");
      button.title = `Jump to the first occurrence of this ${subject} in the document`;
      const icon = document.querySelector(".icon_angle_double_up");
      button.innerHTML = icon.innerHTML;
      button.dataset.id = id;
      button.dataset.ignore = "true";
      button.addEventListener("click", onButtonClick);
      buttonContainer.prepend(button);
    }
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
  <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
  <svg width="16" height="16" viewBox="0 0 320 512">
    <path
      fill="currentColor"
      d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* jump button */
    .jump_arrow {
      position: relative;
      top: 0.125em;
      margin-right: 5px;
    }
  }

  /* always hide jump button on print */
  @media only print {
    .jump_arrow {
      display: none;
    }
  }
</style>
<!-- 
    Lightbox Plugin

    Makes it such that when a user clicks on an image, the image fills the
    screen and the user can pan/drag/zoom the image and navigate between other
    images in the document.
-->

<script type="module">
  // list of possible zoom/scale factors
  const zooms =
    "0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1, 1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8";
  // whether to fit image to view ('fit'), display at 100% and shrink if
  // necessary ('shrink'), or always display at 100% ('100')
  const defaultZoom = "fit";
  // whether to zoom in/out toward center of view ('true') or mouse ('false')
  const centerZoom = "false";

  // start script
  function start() {
    // run through each <img> element
    const imgs = document.querySelectorAll("figure > img");
    let count = 1;
    for (const img of imgs) {
      img.classList.add("lightbox_document_img");
      img.dataset.number = count;
      img.dataset.total = imgs.length;
      img.addEventListener("click", openLightbox);
      count++;
    }

    // attach mouse and key listeners to window
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("keyup", onKeyUp);
  }

  // when mouse is moved anywhere in window
  function onWindowMouseMove(event) {
    window.mouseX = event.clientX;
    window.mouseY = event.clientY;
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("lightbox_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("lightbox_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeLightbox();
        break;
    }
  }

  // open lightbox
  function openLightbox() {
    const lightbox = makeLightbox(this);
    if (!lightbox) return;

    blurBody(lightbox);
    document.body.appendChild(lightbox);
  }

  // make lightbox
  function makeLightbox(img) {
    // delete lightbox if it exists, start fresh
    closeLightbox();

    // create screen overlay containing lightbox
    const overlay = document.createElement("div");
    overlay.id = "lightbox_overlay";

    // create image info boxes
    const numberInfo = document.createElement("div");
    const zoomInfo = document.createElement("div");
    numberInfo.id = "lightbox_number_info";
    zoomInfo.id = "lightbox_zoom_info";

    // create container for image
    const imageContainer = document.createElement("div");
    imageContainer.id = "lightbox_image_container";
    const lightboxImg = makeLightboxImg(
      img,
      imageContainer,
      numberInfo,
      zoomInfo
    );
    imageContainer.appendChild(lightboxImg);

    // create bottom container for caption and navigation buttons
    const bottomContainer = document.createElement("div");
    bottomContainer.id = "lightbox_bottom_container";
    const caption = makeCaption(img);
    const prevButton = makePrevButton(img);
    const nextButton = makeNextButton(img);
    bottomContainer.appendChild(prevButton);
    bottomContainer.appendChild(caption);
    bottomContainer.appendChild(nextButton);

    // attach top middle and bottom to overlay
    overlay.appendChild(numberInfo);
    overlay.appendChild(zoomInfo);
    overlay.appendChild(imageContainer);
    overlay.appendChild(bottomContainer);

    return overlay;
  }

  // make <img> object that is intuitively draggable and zoomable
  function makeLightboxImg(sourceImg, container, numberInfoBox, zoomInfoBox) {
    // create copy of source <img>
    const img = sourceImg.cloneNode(true);
    img.classList.remove("lightbox_document_img");
    img.removeAttribute("id");
    img.removeAttribute("width");
    img.removeAttribute("height");
    img.style.position = "unset";
    img.style.margin = "0";
    img.style.padding = "0";
    img.style.width = "";
    img.style.height = "";
    img.style.minWidth = "";
    img.style.minHeight = "";
    img.style.maxWidth = "";
    img.style.maxHeight = "";
    img.id = "lightbox_img";

    // build sorted list of zoomSteps
    const zoomSteps = zooms.split(/[^0-9.]/).map((step) => parseFloat(step));
    zoomSteps.sort((a, b) => a - b);

    // <img> object property variables
    let zoom = 1;
    let translateX = 0;
    let translateY = 0;
    let clickMouseX = undefined;
    let clickMouseY = undefined;
    let clickTranslateX = undefined;
    let clickTranslateY = undefined;

    updateNumberInfo();

    // update image numbers displayed in info box
    function updateNumberInfo() {
      numberInfoBox.innerHTML =
        sourceImg.dataset.number + " of " + sourceImg.dataset.total;
    }

    // update zoom displayed in info box
    function updateZoomInfo() {
      let zoomInfo = zoom * 100;
      if (!Number.isInteger(zoomInfo)) zoomInfo = zoomInfo.toFixed(2);
      zoomInfoBox.innerHTML = zoomInfo + "%";
    }

    // move to closest zoom step above current zoom
    const zoomIn = function () {
      for (const zoomStep of zoomSteps) {
        if (zoomStep > zoom) {
          zoom = zoomStep;
          break;
        }
      }
      updateTransform();
    };

    // move to closest zoom step above current zoom
    const zoomOut = function () {
      zoomSteps.reverse();
      for (const zoomStep of zoomSteps) {
        if (zoomStep < zoom) {
          zoom = zoomStep;
          break;
        }
      }
      zoomSteps.reverse();

      updateTransform();
    };

    // update display of <img> based on scale/translate properties
    const updateTransform = function () {
      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      // get new width/height after scale
      const rect = img.getBoundingClientRect();
      // limit translate
      translateX = Math.max(translateX, -rect.width / 2);
      translateX = Math.min(translateX, rect.width / 2);
      translateY = Math.max(translateY, -rect.height / 2);
      translateY = Math.min(translateY, rect.height / 2);

      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      updateZoomInfo();
    };

    // fit <img> to container
    const fit = function () {
      // no x/y offset, 100% zoom by default
      translateX = 0;
      translateY = 0;
      zoom = 1;

      // widths of <img> and container
      const imgWidth = img.naturalWidth;
      const imgHeight = img.naturalHeight;
      const containerWidth = parseFloat(
        window.getComputedStyle(container).width
      );
      const containerHeight = parseFloat(
        window.getComputedStyle(container).height
      );

      // how much zooming is needed to fit <img> to container
      const xRatio = imgWidth / containerWidth;
      const yRatio = imgHeight / containerHeight;
      const maxRatio = Math.max(xRatio, yRatio);
      const newZoom = 1 / maxRatio;

      // fit <img> to container according to option
      if (defaultZoom === "shrink") {
        if (maxRatio > 1) zoom = newZoom;
      } else if (defaultZoom === "fit") zoom = newZoom;

      updateTransform();
    };

    // when mouse wheel is rolled anywhere in container
    const onContainerWheel = function (event) {
      if (!event) return;

      // let ctrl + mouse wheel to zoom behave as normal
      if (event.ctrlKey) return;

      // prevent normal scroll behavior
      event.preventDefault();
      event.stopPropagation();

      // point around which to scale img
      const viewRect = container.getBoundingClientRect();
      const viewX = (viewRect.left + viewRect.right) / 2;
      const viewY = (viewRect.top + viewRect.bottom) / 2;
      const originX = centerZoom === "true" ? viewX : mouseX;
      const originY = centerZoom === "true" ? viewY : mouseY;

      // get point on image under origin
      const oldRect = img.getBoundingClientRect();
      const oldPercentX = (originX - oldRect.left) / oldRect.width;
      const oldPercentY = (originY - oldRect.top) / oldRect.height;

      // increment/decrement zoom
      if (event.deltaY < 0) zoomIn();
      if (event.deltaY > 0) zoomOut();

      // get offset between previous image point and origin
      const newRect = img.getBoundingClientRect();
      const offsetX = originX - (newRect.left + newRect.width * oldPercentX);
      const offsetY = originY - (newRect.top + newRect.height * oldPercentY);

      // translate image to keep image point under origin
      translateX += offsetX;
      translateY += offsetY;

      // perform translate
      updateTransform();
    };

    // when container is clicked
    function onContainerClick(event) {
      // if container itself is target of click, and not other
      // element above it
      if (event.target === this) closeLightbox();
    }

    // when mouse button is pressed on image
    const onImageMouseDown = function (event) {
      // store original mouse position relative to image
      clickMouseX = window.mouseX;
      clickMouseY = window.mouseY;
      clickTranslateX = translateX;
      clickTranslateY = translateY;
      event.stopPropagation();
      event.preventDefault();
    };

    // when mouse button is released anywhere in window
    const onWindowMouseUp = function (event) {
      // reset original mouse position
      clickMouseX = undefined;
      clickMouseY = undefined;
      clickTranslateX = undefined;
      clickTranslateY = undefined;

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mouseup", onWindowMouseUp);
    };

    // when mouse is moved anywhere in window
    const onWindowMouseMove = function (event) {
      if (
        clickMouseX === undefined ||
        clickMouseY === undefined ||
        clickTranslateX === undefined ||
        clickTranslateY === undefined
      )
        return;

      // offset image based on original and current mouse position
      translateX = clickTranslateX + window.mouseX - clickMouseX;
      translateY = clickTranslateY + window.mouseY - clickMouseY;
      updateTransform();
      event.preventDefault();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mousemove", onWindowMouseMove);
    };

    // when window is resized
    const onWindowResize = function (event) {
      fit();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("resize", onWindowResize);
    };

    // attach the necessary event listeners
    img.addEventListener("dblclick", fit);
    img.addEventListener("mousedown", onImageMouseDown);
    container.addEventListener("wheel", onContainerWheel);
    container.addEventListener("mousedown", onContainerClick);
    container.addEventListener("touchstart", onContainerClick);
    window.addEventListener("mouseup", onWindowMouseUp);
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("resize", onWindowResize);

    // run fit() after lightbox atttached to document and <img> Loaded
    // so needed container and img dimensions available
    img.addEventListener("load", fit);

    return img;
  }

  // make caption
  function makeCaption(img) {
    const caption = document.createElement("div");
    caption.id = "lightbox_caption";
    const captionSource = img.nextElementSibling;
    if (captionSource.tagName.toLowerCase() === "figcaption") {
      const captionCopy = makeCopy(captionSource);
      caption.innerHTML = captionCopy.innerHTML;
    }

    caption.addEventListener("touchstart", function (event) {
      event.stopPropagation();
    });

    return caption;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // make button to jump to previous image in document
  function makePrevButton(img) {
    const prevButton = document.createElement("button");
    prevButton.id = "lightbox_prev_button";
    prevButton.title = "Jump to the previous image in the document [←]";
    prevButton.classList.add("icon_button", "lightbox_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;

    // attach click listeners to button
    prevButton.addEventListener("click", function () {
      getPrevImg(img).click();
    });

    return prevButton;
  }

  // make button to jump to next image in document
  function makeNextButton(img) {
    const nextButton = document.createElement("button");
    nextButton.id = "lightbox_next_button";
    nextButton.title = "Jump to the next image in the document [→]";
    nextButton.classList.add("icon_button", "lightbox_button");
    nextButton.innerHTML = document.querySelector(
      ".icon_caret_right"
    ).innerHTML;

    // attach click listeners to button
    nextButton.addEventListener("click", function () {
      getNextImg(img).click();
    });

    return nextButton;
  }

  // get previous image in document
  function getPrevImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if < 1
    if (index - 1 >= 0) index--;
    else index = imgs.length - 1;
    return imgs[index];
  }

  // get next image in document
  function getNextImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if > total
    if (index + 1 <= imgs.length - 1) index++;
    else index = 0;
    return imgs[index];
  }

  // close lightbox
  function closeLightbox() {
    focusBody();

    const lightbox = document.getElementById("lightbox_overlay");
    if (lightbox) lightbox.remove();
  }

  // make all elements behind lightbox non-focusable
  function blurBody(overlay) {
    const all = document.querySelectorAll("*");
    for (const element of all) element.tabIndex = -1;
    document.body.classList.add("body_no_scroll");
  }

  // make all elements focusable again
  function focusBody() {
    const all = document.querySelectorAll("*");
    for (const element of all) element.removeAttribute("tabIndex");
    document.body.classList.remove("body_no_scroll");
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* regular <img> in document when hovered */
    img.lightbox_document_img:hover {
      cursor: pointer;
    }

    .body_no_scroll {
      overflow: hidden !important;
    }

    /* screen overlay */
    #lightbox_overlay {
      display: flex;
      flex-direction: column;
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: 3;
    }

    /* middle area containing lightbox image */
    #lightbox_image_container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      position: relative;
      padding: 20px;
    }

    /* bottom area containing caption */
    #lightbox_bottom_container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
      min-height: 100px;
      max-height: 100px;
      background: rgba(0, 0, 0, 0.5);
    }

    /* image number info text box */
    #lightbox_number_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      left: 2px;
      top: 0;
      z-index: 4;
    }

    /* zoom info text box */
    #lightbox_zoom_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      right: 2px;
      top: 0;
      z-index: 4;
    }

    /* copy of image caption */
    #lightbox_caption {
      box-sizing: border-box;
      display: inline-block;
      width: 100%;
      max-height: 100%;
      padding: 10px 0;
      text-align: center;
      overflow-y: auto;
      color: #ffffff;
    }

    /* navigation previous/next button */
    .lightbox_button {
      width: 100px;
      height: 100%;
      min-width: 100px;
      min-height: 100%;
      color: #ffffff;
    }

    /* navigation previous/next button when hovered */
    .lightbox_button:hover {
      background: none !important;
    }

    /* navigation button icon */
    .lightbox_button > svg {
      height: 25px;
    }

    /* figure auto-number */
    #lightbox_caption > span:first-of-type {
      font-weight: bold;
      margin-right: 5px;
    }

    /* lightbox image when hovered */
    #lightbox_img:hover {
      cursor: grab;
    }

    /* lightbox image when grabbed */
    #lightbox_img:active {
      cursor: grabbing;
    }
  }

  /* when on screen < 480px wide */
  @media only screen and (max-width: 480px) {
    /* make navigation buttons skinnier on small screens to make more room for caption text */
    .lightbox_button {
      width: 50px;
      min-width: 50px;
    }
  }

  /* always hide lightbox on print */
  @media only print {
    #lightbox_overlay {
      display: none;
    }
  }
</style>
<!-- 
  Link Highlight Plugin

  Makes it such that when a user hovers or focuses a link, other links that have
  the same target will be highlighted. It also makes it such that when clicking
  a link, the target of the link (eg reference, figure, table) is briefly
  highlighted.
-->

<script type="module">
  // whether to also highlight links that go to external urls
  const externalLinks = "false";
  // whether user must click off to unhighlight instead of just
  // un-hovering
  const clickUnhighlight = "false";
  // whether to also highlight links that are unique
  const highlightUnique = "true";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach mouse and focus listeners to link
      link.addEventListener("mouseenter", onLinkFocus);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("mouseleave", onLinkUnhover);
    }

    // attach click and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("hashchange", onHashChange);

    // run hash change on window load in case user has navigated
    // directly to hash
    onHashChange();
  }

  // when link is focused (tabbed to) or hovered
  function onLinkFocus() {
    highlight(this);
  }

  // when link is unhovered
  function onLinkUnhover() {
    if (clickUnhighlight !== "true") unhighlightAll();
  }

  // when the mouse is clicked anywhere in window
  function onClick(event) {
    unhighlightAll();
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) glowElement(target);
  }

  // start glow sequence on an element
  function glowElement(element) {
    const startGlow = function () {
      onGlowEnd();
      element.dataset.glow = "true";
      element.addEventListener("animationend", onGlowEnd);
    };
    const onGlowEnd = function () {
      element.removeAttribute("data-glow");
      element.removeEventListener("animationend", onGlowEnd);
    };
    startGlow();
  }

  // highlight link and all others with same target
  function highlight(link) {
    // force unhighlight all to start fresh
    unhighlightAll();

    // get links with same target
    if (!link) return;
    const sameLinks = getSameLinks(link);

    // if link unique and option is off, exit and don't highlight
    if (sameLinks.length <= 1 && highlightUnique !== "true") return;

    // highlight all same links, and "select" (special highlight) this
    // one
    for (const sameLink of sameLinks) {
      if (sameLink === link) sameLink.setAttribute("data-selected", "true");
      else sameLink.setAttribute("data-highlighted", "true");
    }
  }

  // unhighlight all links
  function unhighlightAll() {
    const links = getLinks();
    for (const link of links) {
      link.setAttribute("data-selected", "false");
      link.setAttribute("data-highlighted", "false");
    }
  }

  // get links with same target
  function getSameLinks(link) {
    const results = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        results.push(otherLink);
    }
    return results;
  }

  // get all links of types we wish to handle
  function getLinks() {
    let query = "a";
    if (externalLinks !== "true") query += '[href^="#"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelectorAll(query);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<style>
  @media only screen {
    /* anything with data-highlighted attribute true */
    [data-highlighted="true"] {
      background: #ffeb3b;
    }

    /* anything with data-selected attribute true */
    [data-selected="true"] {
      background: #ff8a65 !important;
    }

    /* animation definition for glow */
    @keyframes highlight_glow {
      0% {
        background: none;
      }
      10% {
        background: #bbdefb;
      }
      100% {
        background: none;
      }
    }

    /* anything with data-glow attribute true */
    [data-glow="true"] {
      animation: highlight_glow 2s;
    }
  }
</style>
<!--
  Table of Contents Plugin

  Provides a "table of contents" (toc) panel on the side of the document that
  allows the user to conveniently navigate between sections of the document.
-->

<script type="module">
  // which types of elements to add links for, in "document.querySelector" format
  const typesQuery = "h1, h2, h3";
  // whether toc starts open. use 'true' or 'false', or 'auto' to
  // use 'true' behavior when screen wide enough and 'false' when not
  const startOpen = "false";
  // whether toc closes when clicking on toc link. use 'true' or
  // 'false', or 'auto' to use 'false' behavior when screen wide
  // enough and 'true' when not
  const clickClose = "auto";
  // if list item is more than this many characters, text will be
  // truncated
  const charLimit = "50";
  // whether or not to show bullets next to each toc item
  const bullets = "false";

  // start script
  function start() {
    // make toc panel and populate with entries (links to document
    // sections)
    const panel = makePanel();
    if (!panel) return;
    makeEntries(panel);
    // attach panel to document after making entries, so 'toc' heading
    // in panel isn't included in toc
    document.body.insertBefore(panel, document.body.firstChild);

    // initial panel state
    if (startOpen === "true" || (startOpen === "auto" && !isSmallScreen()))
      openPanel();
    else closePanel();

    // attach click, scroll, and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("scroll", onScroll);
    window.addEventListener("hashchange", onScroll);
    window.addEventListener("keyup", onKeyUp);
    onScroll();

    // add class to push document body down out of way of toc button
    document.body.classList.add("toc_body_nudge");
  }

  // determine if screen wide enough to fit toc panel
  function isSmallScreen() {
    // in default theme:
    // 816px = 8.5in = width of "page" (<body>) element
    // 260px = min width of toc panel (*2 for both sides of <body>)
    return window.innerWidth < 816 + 260 * 2;
  }

  // when mouse is clicked anywhere in window
  function onClick() {
    if (isSmallScreen()) closePanel();
  }

  // when window is scrolled or hash changed
  function onScroll() {
    highlightViewed();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    // close on esc
    if (event.key === "Escape") closePanel();
  }

  // find entry of currently viewed document section in toc and highlight
  function highlightViewed() {
    const firstId = getFirstInView(typesQuery);

    // get toc entries (links), unhighlight all, then highlight viewed
    const list = document.getElementById("toc_list");
    if (!firstId || !list) return;
    const links = list.querySelectorAll("a");
    for (const link of links) link.dataset.viewing = "false";
    const link = list.querySelector('a[href="#' + firstId + '"]');
    if (!link) return;
    link.dataset.viewing = "true";
  }

  // get first or previous toc listed element in top half of view
  function getFirstInView(query) {
    // get all elements matching query and with id
    const elements = document.querySelectorAll(query);
    const elementsWithIds = [];
    for (const element of elements) {
      if (element.id) elementsWithIds.push(element);
    }

    // get first or previous element in top half of view
    for (let i = 0; i < elementsWithIds.length; i++) {
      const element = elementsWithIds[i];
      const prevElement = elementsWithIds[Math.max(0, i - 1)];
      if (element.getBoundingClientRect().top >= 0) {
        if (element.getBoundingClientRect().top < window.innerHeight / 2)
          return element.id;
        else return prevElement.id;
      }
    }
  }

  // make panel
  function makePanel() {
    // create panel
    const panel = document.createElement("div");
    panel.id = "toc_panel";
    if (bullets === "true") panel.dataset.bullets = "true";

    // create header
    const header = document.createElement("div");
    header.id = "toc_header";

    // create toc button
    const button = document.createElement("button");
    button.id = "toc_button";
    button.innerHTML = document.querySelector(".icon_th_list").innerHTML;
    button.title = "Table of Contents";
    button.classList.add("icon_button");

    // create header text
    const text = document.createElement("h4");
    text.innerHTML = "Table of Contents";

    // create container for toc list
    const list = document.createElement("div");
    list.id = "toc_list";

    // attach click listeners
    panel.addEventListener("click", onPanelClick);
    header.addEventListener("click", onHeaderClick);
    button.addEventListener("click", onButtonClick);

    // attach elements
    header.appendChild(button);
    header.appendChild(text);
    panel.appendChild(header);
    panel.appendChild(list);

    return panel;
  }

  // create toc entries (links) to each element of the specified types
  function makeEntries(panel) {
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) {
      // do not add link if element doesn't have assigned id
      if (!element.id) continue;

      // create link/list item
      const link = document.createElement("a");
      link.classList.add("toc_link");
      switch (element.tagName.toLowerCase()) {
        case "h1":
          link.dataset.level = "1";
          break;
        case "h2":
          link.dataset.level = "2";
          break;
        case "h3":
          link.dataset.level = "3";
          break;
        case "h4":
          link.dataset.level = "4";
          break;
      }
      link.title = element.innerText;
      let text = element.innerText;
      if (text.length > charLimit) text = text.slice(0, charLimit) + "...";
      link.innerHTML = text;
      link.href = "#" + element.id;
      link.addEventListener("click", onLinkClick);

      // attach link
      panel.querySelector("#toc_list").appendChild(link);
    }
  }

  // when panel is clicked
  function onPanelClick(event) {
    // stop click from propagating to window/document and closing panel
    event.stopPropagation();
  }

  // when header itself is clicked
  function onHeaderClick(event) {
    togglePanel();
  }

  // when button is clicked
  function onButtonClick(event) {
    togglePanel();
    // stop header underneath button from also being clicked
    event.stopPropagation();
  }

  // when link is clicked
  function onLinkClick(event) {
    if (clickClose === "true" || (clickClose === "auto" && isSmallScreen()))
      closePanel();
    else openPanel();
  }

  // open panel if closed, close if opened
  function togglePanel() {
    const panel = document.getElementById("toc_panel");
    if (!panel) return;

    if (panel.dataset.open === "true") closePanel();
    else openPanel();
  }

  // open panel
  function openPanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "true";
  }

  // close panel
  function closePanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "false";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- th list icon -->

<template class="icon_th_list">
  <!-- modified from: https://fontawesome.com/icons/th-list -->
  <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
    <path
      fill="currentColor"
      d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* toc panel */
    #toc_panel {
      box-sizing: border-box;
      position: fixed;
      top: 0;
      left: 0;
      background: #ffffff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      z-index: 2;
    }

    /* toc panel when closed */
    #toc_panel[data-open="false"] {
      min-width: 60px;
      width: 60px;
      height: 60px;
      border-right: solid 1px #bdbdbd;
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc panel when open */
    #toc_panel[data-open="true"] {
      min-width: 260px;
      max-width: 480px;
      /* keep panel edge consistent distance away from "page" edge */
      width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
      bottom: 0;
      border-right: solid 1px #bdbdbd;
    }

    /* toc panel header */
    #toc_header {
      box-sizing: border-box;
      display: flex;
      flex-direction: row;
      align-items: center;
      height: 60px;
      margin: 0;
      padding: 20px;
    }

    /* toc panel header when hovered */
    #toc_header:hover {
      cursor: pointer;
    }

    /* toc panel header when panel open */
    #toc_panel[data-open="true"] > #toc_header {
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc open/close header button */
    #toc_button {
      margin-right: 20px;
    }

    /* hide toc list and header text when closed */
    #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
    #toc_panel[data-open="false"] > #toc_list {
      display: none;
    }

    /* toc list of entries */
    #toc_list {
      box-sizing: border-box;
      width: 100%;
      padding: 20px;
      position: absolute;
      top: calc(60px + 1px);
      bottom: 0;
      overflow: auto;
    }

    /* toc entry, link to section in document */
    .toc_link {
      display: block;
      padding: 5px;
      position: relative;
      font-weight: 600;
      text-decoration: none;
    }

    /* toc entry when hovered or when "viewed" */
    .toc_link:hover,
    .toc_link[data-viewing="true"] {
      background: #f5f5f5;
    }

    /* toc entry, level 1 indentation */
    .toc_link[data-level="1"] {
      margin-left: 0;
    }

    /* toc entry, level 2 indentation */
    .toc_link[data-level="2"] {
      margin-left: 20px;
    }

    /* toc entry, level 3 indentation */
    .toc_link[data-level="3"] {
      margin-left: 40px;
    }

    /* toc entry, level 4 indentation */
    .toc_link[data-level="4"] {
      margin-left: 60px;
    }

    /* toc entry bullets */
    #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
      position: absolute;
      left: -15px;
      top: -1px;
      font-size: 1.5em;
    }

    /* toc entry, level 2 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
      content: "\2022";
    }

    /* toc entry, level 3 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
      content: "\25AB";
    }

    /* toc entry, level 4 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
      content: "-";
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* push <body> ("page") element down to make room for toc icon */
    .toc_body_nudge {
      padding-top: 60px;
    }

    /* toc icon when panel closed and not hovered */
    #toc_panel[data-open="false"]:not(:hover) {
      background: rgba(255, 255, 255, 0.75);
    }
  }

  /* always hide toc panel on print */
  @media only print {
    #toc_panel {
      display: none;
    }
  }
</style>
<!-- 
  Tooltips Plugin

  Makes it such that when the user hovers or focuses a link to a citation or
  figure, a tooltip appears with a preview of the reference content, along with
  arrows to navigate between instances of the same reference in the document.
-->

<script type="module">
  // whether user must click off to close tooltip instead of just un-hovering
  const clickClose = "false";
  // delay (in ms) between opening and closing tooltip
  const delay = "100";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach hover and focus listeners to link
      link.addEventListener("mouseover", onLinkHover);
      link.addEventListener("mouseleave", onLinkUnhover);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("touchend", onLinkTouch);
    }

    // attach mouse, key, and resize listeners to window
    window.addEventListener("mousedown", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("keyup", onKeyUp);
    window.addEventListener("resize", onResize);
  }

  // when link is hovered
  function onLinkHover() {
    // function to open tooltip
    const delayOpenTooltip = function () {
      openTooltip(this);
    }.bind(this);

    // run open function after delay
    this.openTooltipTimer = window.setTimeout(delayOpenTooltip, delay);
  }

  // when mouse leaves link
  function onLinkUnhover() {
    // cancel opening tooltip
    window.clearTimeout(this.openTooltipTimer);

    // don't close on unhover if option specifies
    if (clickClose === "true") return;

    // function to close tooltip
    const delayCloseTooltip = function () {
      // if tooltip open and if mouse isn't over tooltip, close
      const tooltip = document.getElementById("tooltip");
      if (tooltip && !tooltip.matches(":hover")) closeTooltip();
    };

    // run close function after delay
    this.closeTooltipTimer = window.setTimeout(delayCloseTooltip, delay);
  }

  // when link is focused (tabbed to)
  function onLinkFocus(event) {
    openTooltip(this);
  }

  // when link is touched on touch screen
  function onLinkTouch(event) {
    // attempt to force hover state on first tap always, and trigger
    // regular link click (and navigation) on second tap
    if (event.target === document.activeElement) event.target.click();
    else {
      document.activeElement.blur();
      event.target.focus();
    }
    if (event.cancelable) event.preventDefault();
    event.stopPropagation();
    return false;
  }

  // when mouse is clicked anywhere in window
  function onClick(event) {
    closeTooltip();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("tooltip_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("tooltip_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeTooltip();
        break;
    }
  }

  // when window is resized or zoomed
  function onResize() {
    closeTooltip();
  }

  // get all links of types we wish to handle
  function getLinks() {
    const queries = [];
    // exclude buttons, anchor links, toc links, etc
    const exclude =
      ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    queries.push('a[href^="#ref-"]' + exclude); // citation links
    queries.push('a[href^="#fig:"]' + exclude); // figure links
    const query = queries.join(", ");
    return document.querySelectorAll(query);
  }

  // get links with same target, get index of link in set, get total
  // same links
  function getSameLinks(link) {
    const sameLinks = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        sameLinks.push(otherLink);
    }

    return {
      elements: sameLinks,
      index: sameLinks.indexOf(link),
      total: sameLinks.length,
    };
  }

  // open tooltip
  function openTooltip(link) {
    // delete tooltip if it exists, start fresh
    closeTooltip();

    // make tooltip element
    const tooltip = makeTooltip(link);

    // if source couldn't be found and tooltip not made, exit
    if (!tooltip) return;

    // make navbar elements
    const navBar = makeNavBar(link);
    if (navBar) tooltip.firstElementChild.appendChild(navBar);

    // attach tooltip to page
    document.body.appendChild(tooltip);

    // position tooltip
    const position = function () {
      positionTooltip(link);
    };
    position();

    // if tooltip contains images, position again after they've loaded
    const imgs = tooltip.querySelectorAll("img");
    for (const img of imgs) img.addEventListener("load", position);
  }

  // close (delete) tooltip
  function closeTooltip() {
    const tooltip = document.getElementById("tooltip");
    if (tooltip) tooltip.remove();
  }

  // make tooltip
  function makeTooltip(link) {
    // get target element that link points to
    const source = getSource(link);

    // if source can't be found, exit
    if (!source) return;

    // create new tooltip
    const tooltip = document.createElement("div");
    tooltip.id = "tooltip";
    const tooltipContent = document.createElement("div");
    tooltipContent.id = "tooltip_content";
    tooltip.appendChild(tooltipContent);

    // make copy of source node and put in tooltip
    const sourceCopy = makeCopy(source);
    tooltipContent.appendChild(sourceCopy);

    // attach mouse event listeners
    tooltip.addEventListener("click", onTooltipClick);
    tooltip.addEventListener("mousedown", onTooltipClick);
    tooltip.addEventListener("touchstart", onTooltipClick);
    tooltip.addEventListener("mouseleave", onTooltipUnhover);

    // (for interaction with lightbox plugin)
    // transfer click on tooltip copied img to original img
    const sourceImg = source.querySelector("img");
    const sourceCopyImg = sourceCopy.querySelector("img");
    if (sourceImg && sourceCopyImg) {
      const clickImg = function () {
        sourceImg.click();
        closeTooltip();
      };
      sourceCopyImg.addEventListener("click", clickImg);
    }

    return tooltip;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
      "class",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // when tooltip is clicked
  function onTooltipClick(event) {
    // when user clicks on tooltip, stop click from transferring
    // outside of tooltip (eg, click off to close tooltip, or eg click
    // off to unhighlight same refs)
    event.stopPropagation();
  }

  // when tooltip is unhovered
  function onTooltipUnhover(event) {
    if (clickClose === "true") return;

    // make sure new mouse/touch/focus no longer over tooltip or any
    // element within it
    const tooltip = document.getElementById("tooltip");
    if (!tooltip) return;
    if (this.contains(event.relatedTarget)) return;

    closeTooltip();
  }

  // make nav bar to go betwen prev/next instances of same reference
  function makeNavBar(link) {
    // find other links to the same source
    const sameLinks = getSameLinks(link);

    // don't show nav bar when singular reference
    if (sameLinks.total <= 1) return;

    // find prev/next links with same target
    const prevLink = getPrevLink(link, sameLinks);
    const nextLink = getNextLink(link, sameLinks);

    // create nav bar
    const navBar = document.createElement("div");
    navBar.id = "tooltip_nav_bar";
    const text = sameLinks.index + 1 + " of " + sameLinks.total;

    // create nav bar prev/next buttons
    const prevButton = document.createElement("button");
    const nextButton = document.createElement("button");
    prevButton.id = "tooltip_prev_button";
    nextButton.id = "tooltip_next_button";
    prevButton.title =
      "Jump to the previous occurence of this item in the document [←]";
    nextButton.title =
      "Jump to the next occurence of this item in the document [→]";
    prevButton.classList.add("icon_button");
    nextButton.classList.add("icon_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;
    nextButton.innerHTML =
      document.querySelector(".icon_caret_right").innerHTML;
    navBar.appendChild(prevButton);
    navBar.appendChild(document.createTextNode(text));
    navBar.appendChild(nextButton);

    // attach click listeners to buttons
    prevButton.addEventListener("click", function () {
      onPrevNextClick(link, prevLink);
    });
    nextButton.addEventListener("click", function () {
      onPrevNextClick(link, nextLink);
    });

    return navBar;
  }

  // get previous link with same target
  function getPrevLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if < 1
    let index;
    if (sameLinks.index - 1 >= 0) index = sameLinks.index - 1;
    else index = sameLinks.total - 1;
    return sameLinks.elements[index];
  }

  // get next link with same target
  function getNextLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if > total
    let index;
    if (sameLinks.index + 1 <= sameLinks.total - 1) index = sameLinks.index + 1;
    else index = 0;
    return sameLinks.elements[index];
  }

  // get element that is target of link or url hash
  function getSource(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector('[id="' + id + '"]');
    if (!target) return;

    // if ref or figure, modify target to get expected element
    if (id.indexOf("ref-") === 0) target = target.querySelector(":nth-child(2)");
    else if (id.indexOf("fig:") === 0) target = target.querySelector("figure");

    return target;
  }

  // when prev/next arrow button is clicked
  function onPrevNextClick(link, prevNextLink) {
    if (link && prevNextLink)
      goToElement(prevNextLink, window.innerHeight * 0.5);
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);
    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // determine position to place tooltip based on link position in
  // viewport and tooltip size
  function positionTooltip(link, left, top) {
    const tooltipElement = document.getElementById("tooltip");
    if (!tooltipElement) return;

    // get convenient vars for position/dimensions of
    // link/tooltip/page/view
    link = getRectInPage(link);
    const tooltip = getRectInPage(tooltipElement);
    const view = getRectInPage();

    // horizontal positioning
    if (left)
      // use explicit value
      left = left;
    else if (link.left + tooltip.width < view.right)
      // fit tooltip to right of link
      left = link.left;
    else if (link.right - tooltip.width > view.left)
      // fit tooltip to left of link
      left = link.right - tooltip.width;
    // center tooltip in view
    else left = (view.right - view.left) / 2 - tooltip.width / 2;

    // vertical positioning
    if (top)
      // use explicit value
      top = top;
    else if (link.top - tooltip.height > view.top)
      // fit tooltip above link
      top = link.top - tooltip.height;
    else if (link.bottom + tooltip.height < view.bottom)
      // fit tooltip below link
      top = link.bottom;
    else {
      // center tooltip in view
      top = view.top + view.height / 2 - tooltip.height / 2;
      // nudge off of link to left/right if possible
      if (link.right + tooltip.width < view.right) left = link.right;
      else if (link.left - tooltip.width > view.left)
        left = link.left - tooltip.width;
    }

    tooltipElement.style.left = left + "px";
    tooltipElement.style.top = top + "px";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* tooltip container */
    #tooltip {
      position: absolute;
      width: 50%;
      min-width: 240px;
      max-width: 75%;
      z-index: 1;
    }

    /* tooltip content */
    #tooltip_content {
      margin-bottom: 5px;
      padding: 20px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
      overflow-wrap: break-word;
    }

    /* tooltip copy of paragraphs and figures */
    #tooltip_content > p,
    #tooltip_content > figure {
      margin: 0;
      max-height: 320px;
      overflow-y: auto;
    }

    /* tooltip copy of <img> */
    #tooltip_content > figure > img,
    #tooltip_content > figure > svg {
      max-height: 260px;
    }

    /* navigation bar */
    #tooltip_nav_bar {
      margin-top: 10px;
      text-align: center;
    }

    /* navigation bar previous/next buton */
    #tooltip_nav_bar > .icon_button {
      position: relative;
      top: 3px;
    }

    /* navigation bar previous button */
    #tooltip_nav_bar > .icon_button:first-of-type {
      margin-right: 5px;
    }

    /* navigation bar next button */
    #tooltip_nav_bar > .icon_button:last-of-type {
      margin-left: 5px;
    }
  }

  /* always hide tooltip on print */
  @media only print {
    #tooltip {
      display: none;
    }
  }
</style>
<!--
  Analytics Plugin (third-party) 
  
  Copy and paste code from Google Analytics or similar service here.
-->
<!-- 
  Annotations Plugin

  Allows public annotation of the  manuscript. See https://web.hypothes.is/.
-->

<script type="module">
  // configuration
  window.hypothesisConfig = function () {
    return {
      branding: {
        accentColor: "#2196f3",
        appBackgroundColor: "#f8f8f8",
        ctaBackgroundColor: "#f8f8f8",
        ctaTextColor: "#000000",
        selectionFontFamily: "Open Sans, Helvetica, sans serif",
        annotationFontFamily: "Open Sans, Helvetica, sans serif",
      },
    };
  };

  // hypothesis client script
  const embed = "https://hypothes.is/embed.js";
  // hypothesis annotation count query url
  const query = "https://api.hypothes.is/api/search?limit=0&url=";

  // start script
  function start() {
    const button = makeButton();
    document.body.insertBefore(button, document.body.firstChild);
    insertCount(button);
  }

  // make button
  function makeButton() {
    // create button
    const button = document.createElement("button");
    button.id = "hypothesis_button";
    button.innerHTML = document.querySelector(".icon_hypothesis").innerHTML;
    button.title = "Hypothesis annotations";
    button.classList.add("icon_button");

    function onClick(event) {
      onButtonClick(event, button);
    }

    // attach click listeners
    button.addEventListener("click", onClick);

    return button;
  }

  // insert annotations count
  async function insertCount(button) {
    // get annotation count from Hypothesis based on url
    let count = "-";
    try {
      const canonical = document.querySelector('link[rel="canonical"]');
      const location = window.location;
      const url = encodeURIComponent((canonical || location).href);
      const response = await fetch(query + url);
      const json = await response.json();
      count = json.total || "-";
    } catch (error) {
      console.log(error);
    }

    // put count into button
    const counter = document.createElement("span");
    counter.id = "hypothesis_count";
    counter.innerHTML = count;
    button.title = "View " + count + " Hypothesis annotations";
    button.append(counter);
  }

  // when button is clicked
  function onButtonClick(event, button) {
    const script = document.createElement("script");
    script.src = embed;
    document.body.append(script);
    button.remove();
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- hypothesis icon -->

<template class="icon_hypothesis">
  <!-- modified from: https://simpleicons.org/icons/hypothesis.svg / https://git.io/Jf1VB -->
  <svg width="16" height="16" viewBox="0 0 24 24" tabindex="-1">
    <path
      fill="currentColor"
      d="M3.43 0C2.5 0 1.72 .768 1.72 1.72V18.86C1.72 19.8 2.5 20.57 3.43 20.57H9.38L12 24L14.62 20.57H20.57C21.5 20.57 22.29 19.8 22.29 18.86V1.72C22.29 .77 21.5 0 20.57 0H3.43M5.14 3.43H7.72V9.43S8.58 7.72 10.28 7.72C12 7.72 13.74 8.57 13.74 11.24V17.14H11.16V12C11.16 10.61 10.28 10.07 9.43 10.29C8.57 10.5 7.72 11.41 7.72 13.29V17.14H5.14V3.43M18 13.72C18.95 13.72 19.72 14.5 19.72 15.42A1.71 1.71 0 0 1 18 17.13A1.71 1.71 0 0 1 16.29 15.42C16.29 14.5 17.05 13.71 18 13.71Z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  /* hypothesis activation button */
  #hypothesis_button {
    box-sizing: border-box;
    position: fixed;
    top: 0;
    right: 0;
    width: 60px;
    height: 60px;
    background: #ffffff;
    border-radius: 0;
    border-left: solid 1px #bdbdbd;
    border-bottom: solid 1px #bdbdbd;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    z-index: 2;
  }

  /* hypothesis button svg */
  #hypothesis_button > svg {
    position: relative;
    top: -4px;
  }

  /* hypothesis annotation count */
  #hypothesis_count {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 5px;
  }

  /* side panel */
  .annotator-frame {
    width: 280px !important;
  }

  /* match highlight color to rest of theme */
  .annotator-highlights-always-on .annotator-hl {
    background-color: #ffeb3b !important;
  }

  /* match focused color to rest of theme */
  .annotator-hl.annotator-hl-focused {
    background-color: #ff8a65 !important;
  }

  /* match bucket bar color to rest of theme */
  .annotator-bucket-bar {
    background: #f5f5f5 !important;
  }

  /* always hide button, toolbar, and tooltip on print */
  @media only print {
    #hypothesis_button {
      display: none;
    }

    .annotator-frame {
      display: none !important;
    }

    hypothesis-adder {
      display: none !important;
    }
  }
</style>
<!-- 
  Mathjax Plugin (third-party) 

  Allows the proper rendering of math/equations written in LaTeX.
  See https://www.mathjax.org/.
-->

<script type="text/x-mathjax-config">
  // configuration
  MathJax.Hub.Config({
    "CommonHTML": { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
    "SVG": { linebreaks: { automatic: true } },
    "fast-preview": { disabled: true }
  });
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A=="
  crossorigin="anonymous"
></script>

<style>
  /* mathjax containers */
  .math.display > span:not(.MathJax_Preview) {
    /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
    display: flex !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    justify-content: center;
    align-items: center;
    margin: 0 !important;
  }

  /* right click menu */
  .MathJax_Menu {
    border-radius: 5px !important;
    border: solid 1px #bdbdbd !important;
    box-shadow: none !important;
  }

  /* equation auto-number */
  span[id^="eq:"] > span.math.display + span {
    font-weight: 600;
  }

  /* equation */
  span[id^="eq:"] > span.math.display > span {
    /* nudge to make room for equation auto-number and anchor */
    margin-right: 60px !important;
  }
</style>
</body>
</html>
